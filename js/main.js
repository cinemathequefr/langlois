function fitInBox(e,t,i,n,o){e=parseInt(e),t=parseInt(t),i=parseInt(i),n=parseInt(n);var r=e/t,s=e,a=t;return(e>i||n>t)&&(e=i,t=Math.floor(e/r)),(t>n||i>e)&&(t=n,e=Math.floor(t*r)),!!o==!1&&(e>=s||t>=a)&&(e=s,t=a),{width:e,height:t}}jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,i,n,o){return jQuery.easing[jQuery.easing.def](e,t,i,n,o)},easeInQuad:function(e,t,i,n,o){return n*(t/=o)*t+i},easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i},easeInOutQuad:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,o){return n*(t/=o)*t*t+i},easeOutCubic:function(e,t,i,n,o){return n*((t=t/o-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,o){return n*(t/=o)*t*t*t+i},easeOutQuart:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,o){return n*(t/=o)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,o){return n*((t=t/o-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,o){return-n*Math.cos(t/o*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,o){return n*Math.sin(t/o*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,o){return-n/2*(Math.cos(Math.PI*t/o)-1)+i},easeInExpo:function(e,t,i,n,o){return 0==t?i:n*Math.pow(2,10*(t/o-1))+i},easeOutExpo:function(e,t,i,n,o){return t==o?i+n:n*(-Math.pow(2,-10*t/o)+1)+i},easeInOutExpo:function(e,t,i,n,o){return 0==t?i:t==o?i+n:(t/=o/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,n,o){return-n*(Math.sqrt(1-(t/=o)*t)-1)+i},easeOutCirc:function(e,t,i,n,o){return n*Math.sqrt(1-(t=t/o-1)*t)+i},easeInOutCirc:function(e,t,i,n,o){return(t/=o/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(1==(t/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*o-r)*Math.PI/s))+i},easeOutElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(1==(t/=o))return i+n;if(s||(s=.3*o),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return a*Math.pow(2,-10*t)*Math.sin(2*(t*o-r)*Math.PI/s)+n+i},easeInOutElastic:function(e,t,i,n,o){var r=1.70158,s=0,a=n;if(0==t)return i;if(2==(t/=o/2))return i+n;if(s||(s=.3*o*1.5),a<Math.abs(n)){a=n;var r=s/4}else var r=s/(2*Math.PI)*Math.asin(n/a);return 1>t?-.5*a*Math.pow(2,10*(t-=1))*Math.sin(2*(t*o-r)*Math.PI/s)+i:a*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*o-r)*Math.PI/s)*.5+n+i},easeInBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),n*(t/=o)*t*((r+1)*t-r)+i},easeOutBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),n*((t=t/o-1)*t*((r+1)*t+r)+1)+i},easeInOutBack:function(e,t,i,n,o,r){return void 0==r&&(r=1.70158),(t/=o/2)<1?n/2*t*t*(((r*=1.525)+1)*t-r)+i:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+i},easeInBounce:function(e,t,i,n,o){return n-jQuery.easing.easeOutBounce(e,o-t,0,n,o)+i},easeOutBounce:function(e,t,i,n,o){return(t/=o)<1/2.75?7.5625*n*t*t+i:2/2.75>t?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(e,t,i,n,o){return o/2>t?.5*jQuery.easing.easeInBounce(e,2*t,0,n,o)+i:.5*jQuery.easing.easeOutBounce(e,2*t-o,0,n,o)+.5*n+i}}),function(e,t,i){function n(e,t,i,n,o,r,s,a,l){var u=!1;s=!0===s&&!0===a,t=t||{},t.original||(t.original={},u=!0),t.properties=t.properties||{},t.secondary=t.secondary||{},a=t.meta;for(var c=t.original,d=t.properties,p=t.secondary,m=h.length-1;m>=0;m--){var f=h[m]+"transition-property",g=h[m]+"transition-duration",v=h[m]+"transition-timing-function";i=s?h[m]+"transform":i,u&&(c[f]=e.css(f)||"",c[g]=e.css(g)||"",c[v]=e.css(v)||""),p[i]=s?(!0===l||!0===y&&!1!==l)&&w?"translate3d("+a.left+"px, "+a.top+"px, 0)":"translate("+a.left+"px,"+a.top+"px)":r,d[f]=(d[f]?d[f]+",":"")+i,d[g]=(d[g]?d[g]+",":"")+n+"ms",d[v]=(d[v]?d[v]+",":"")+o}return t}function o(e){for(var t in e)return!1;return!0}function r(e){return parseFloat(e.replace(e.match(/\D+$/),""))}function s(e){var t=!0;return e.each(function(e,i){return t=t&&i.ownerDocument}),t}var a="top right bottom left opacity height width".split(" "),l=["top","right","bottom","left"],h=["-webkit-","-moz-","-o-",""],u=["avoidTransforms","useTranslate3d","leaveTransforms"],c=/^([+-]=)?([\d+-.]+)(.*)$/,d=/([A-Z])/g,p={secondary:{},meta:{top:0,right:0,bottom:0,left:0}},m=null,f=!1,g=(document.body||document.documentElement).style,v=void 0!==g.WebkitTransition||void 0!==g.MozTransition||void 0!==g.OTransition||void 0!==g.transition,w="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,y=w;e.expr&&e.expr.filters&&(m=e.expr.filters.animated,e.expr.filters.animated=function(t){return e(t).data("events")&&e(t).data("events")["webkitTransitionEnd oTransitionEnd transitionend"]?!0:m.call(this,t)}),e.extend({toggle3DByDefault:function(){return y=!y},toggleDisabledByDefault:function(){return f=!f},setDisabledByDefault:function(e){return f=e}}),e.fn.translation=function(){if(!this[0])return null;var e=window.getComputedStyle(this[0],null),t={x:0,y:0};if(e)for(var i=h.length-1;i>=0;i--){var n=e.getPropertyValue(h[i]+"transform");if(n&&/matrix/i.test(n)){e=n.replace(/^matrix\(/i,"").split(/, |\)$/g),t={x:parseInt(e[4],10),y:parseInt(e[5],10)};break}}return t},e.fn.animate=function(i,d,m,g){i=i||{};var w,y=!("undefined"!=typeof i.bottom||"undefined"!=typeof i.right),S=e.speed(d,m,g),b=this,x=0,T=function(){x--,0===x&&"function"==typeof S.complete&&S.complete.apply(b,arguments)};if(!(w=!0===("undefined"!=typeof i.avoidCSSTransitions?i.avoidCSSTransitions:f))&&!(w=!v)&&!(w=o(i))){var E;e:{for(E in i)if(!("width"!=E&&"height"!=E||"show"!=i[E]&&"hide"!=i[E]&&"toggle"!=i[E])){E=!0;break e}E=!1}w=E||0>=S.duration||!0===e.fn.animate.defaults.avoidTransforms&&!1!==i.avoidTransforms}return w?t.apply(this,arguments):this[!0===S.queue?"queue":"each"](function(){var d,m=e(this),f=e.extend({},S),g=function(t){var n=m.data("jQe")||{original:{}},o={};if(2==t.eventPhase){if(!0!==i.leaveTransforms){for(t=h.length-1;t>=0;t--)o[h[t]+"transform"]="";if(y&&"undefined"!=typeof n.meta){t=0;for(var r;r=l[t];++t)o[r]=n.meta[r+"_o"]+"px",e(this).css(r,o[r])}}m.unbind("webkitTransitionEnd oTransitionEnd transitionend").css(n.original).css(o).data("jQe",null),"hide"===i.opacity&&m.css({display:"none",opacity:""}),T.call(this)}},v={bounce:"cubic-bezier(0.0, 0.35, .5, 1.3)",linear:"linear",swing:"ease-in-out",easeInQuad:"cubic-bezier(0.550, 0.085, 0.680, 0.530)",easeInCubic:"cubic-bezier(0.550, 0.055, 0.675, 0.190)",easeInQuart:"cubic-bezier(0.895, 0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755, 0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470, 0.000, 0.745, 0.715)",easeInExpo:"cubic-bezier(0.950, 0.050, 0.795, 0.035)",easeInCirc:"cubic-bezier(0.600, 0.040, 0.980, 0.335)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeOutQuad:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",easeOutCubic:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",easeOutQuart:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeOutExpo:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.320, 1.275)",easeInOutQuad:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1.000)",easeInOutQuart:"cubic-bezier(0.770, 0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860, 0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",easeInOutExpo:"cubic-bezier(1.000, 0.000, 0.000, 1.000)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.150, 0.860)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)"},w={},v=v[f.easing||"swing"]?v[f.easing||"swing"]:f.easing||"swing";for(d in i)if(-1===e.inArray(d,u)){var b,E=-1<e.inArray(d,l),C=m,_=i[d],P=d,O=E&&!0!==i.avoidTransforms;if("d"==P)b=void 0;else if(s(C)){var M=c.exec(_);b="auto"===C.css(P)?0:C.css(P),b="string"==typeof b?r(b):b,"string"==typeof _&&r(_);var O=!0===O?0:b,k=C.is(":hidden"),I=C.translation();"left"==P&&(O=parseInt(b,10)+I.x),"right"==P&&(O=parseInt(b,10)+I.x),"top"==P&&(O=parseInt(b,10)+I.y),"bottom"==P&&(O=parseInt(b,10)+I.y),M||"show"!=_?!M&&"hide"==_&&(O=0):(O=1,k&&C.css({display:"LI"==C.context.tagName?"list-item":"block",opacity:0})),M?(C=parseFloat(M[2]),M[1]&&(C=("-="===M[1]?-1:1)*C+parseInt(O,10)),b=C):b=O}else b=void 0;if((M=!0!==i.avoidTransforms)&&(M=d,C=b,_=m,s(_)?(P=-1<e.inArray(M,a),"width"!=M&&"height"!=M&&"opacity"!=M||parseFloat(C)!==parseFloat(_.css(M))||(P=!1),M=P):M=!1),M){M=m,C=d,_=f.duration,P=v,b=E&&!0===i.avoidTransforms?b+"px":b;var E=E&&!0!==i.avoidTransforms,O=y,k=!0===i.useTranslate3d,I=(I=M.data("jQe"))&&!o(I)?I:e.extend(!0,{},p),R=b;if(-1<e.inArray(C,l)){var D=I.meta,z=r(M.css(C))||0,B=C+"_o",R=b-z;D[C]=R,D[B]="auto"==M.css(C)?0+R:z+R||0,I.meta=D,O&&0===R&&(R=0-D[B],D[C]=R,D[B]=0)}M.data("jQe",n(M,I,C,_,P,R,E,O,k))}else w[d]=i[d]}if(m.unbind("webkitTransitionEnd oTransitionEnd transitionend"),!(d=m.data("jQe"))||o(d)||o(d.secondary))f.queue=!1;else{x++,m.css(d.properties);var H=d.secondary;setTimeout(function(){m.bind("webkitTransitionEnd oTransitionEnd transitionend",g).css(H)})}return o(w)||(x++,t.apply(m,[w,{duration:f.duration,easing:e.easing[f.easing]?f.easing:e.easing.swing?"swing":"linear",complete:T,queue:f.queue}])),!0})},e.fn.animate.defaults={},e.fn.stop=function(t,n,r){return v?(t&&this.queue([]),this.each(function(){var s=e(this),a=s.data("jQe");if(a&&!o(a)){var l,u={};if(n){if(u=a.secondary,!r&&void 0!==typeof a.meta.left_o||void 0!==typeof a.meta.top_o)for(u.left=void 0!==typeof a.meta.left_o?a.meta.left_o:"auto",u.top=void 0!==typeof a.meta.top_o?a.meta.top_o:"auto",l=h.length-1;l>=0;l--)u[h[l]+"transform"]=""}else if(!o(a.secondary)){var c=window.getComputedStyle(s[0],null);if(c)for(var p in a.secondary)if(a.secondary.hasOwnProperty(p)&&(p=p.replace(d,"-$1").toLowerCase(),u[p]=c.getPropertyValue(p),!r&&/matrix/i.test(u[p])))for(l=u[p].replace(/^matrix\(/i,"").split(/, |\)$/g),u.left=parseFloat(l[4])+parseFloat(s.css("left"))+"px"||"auto",u.top=parseFloat(l[5])+parseFloat(s.css("top"))+"px"||"auto",l=h.length-1;l>=0;l--)u[h[l]+"transform"]=""}s.unbind("webkitTransitionEnd oTransitionEnd transitionend"),s.css(a.original).css(u).data("jQe",null)}else i.apply(s,[t,n])}),this):i.apply(this,[t,n])}}(jQuery,jQuery.fn.animate,jQuery.fn.stop),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(t){return e.isFunction(t)||"object"==typeof t?t:{top:t,left:t}}var i=e.scrollTo=function(t,i,n){return e(window).scrollTo(t,i,n)};return i.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},i.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,i=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!i)return t;var n=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"==n.compatMode?n.body:n.documentElement})},e.fn.scrollTo=function(n,o,r){return"object"==typeof o&&(r=o,o=0),"function"==typeof r&&(r={onAfter:r}),"max"==n&&(n=9e9),r=e.extend({},i.defaults,r),o=o||r.duration,r.queue=r.queue&&r.axis.length>1,r.queue&&(o/=2),r.offset=t(r.offset),r.over=t(r.over),this._scrollable().each(function(){function s(e){h.animate(c,o,r.easing,e&&function(){e.call(this,u,r)})}if(null!=n){var a,l=this,h=e(l),u=n,c={},d=h.is("html,body");switch(typeof u){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(u)){u=t(u);break}if(u=e(u,this),!u.length)return;case"object":(u.is||u.style)&&(a=(u=e(u)).offset())}var p=e.isFunction(r.offset)&&r.offset(l,u)||r.offset;e.each(r.axis.split(""),function(e,t){var n="x"==t?"Left":"Top",o=n.toLowerCase(),m="scroll"+n,f=l[m],g=i.max(l,t);if(a)c[m]=a[o]+(d?0:f-h.offset()[o]),r.margin&&(c[m]-=parseInt(u.css("margin"+n))||0,c[m]-=parseInt(u.css("border"+n+"Width"))||0),c[m]+=p[o]||0,r.over[o]&&(c[m]+=u["x"==t?"width":"height"]()*r.over[o]);else{var v=u[o];c[m]=v.slice&&"%"==v.slice(-1)?parseFloat(v)/100*g:v}r.limit&&/^\d+$/.test(c[m])&&(c[m]=c[m]<=0?0:Math.min(c[m],g)),!e&&r.queue&&(f!=c[m]&&s(r.onAfterFirst),delete c[m])}),s(r.onAfter)}}).end()},i.max=function(t,i){var n="x"==i?"Width":"Height",o="scroll"+n;if(!e(t).is("html,body"))return t[o]-e(t)[n.toLowerCase()]();var r="client"+n,s=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(s[o],a[o])-Math.min(s[r],a[r])},i}),function(e){var t,i,n=e.event;t=n.special.debouncedresize={setup:function(){e(this).on("resize",t.handler)},teardown:function(){e(this).off("resize",t.handler)},handler:function(e,o){var r=this,s=arguments,a=function(){e.type="debouncedresize",n.dispatch.apply(r,s)};i&&clearTimeout(i),o?a():i=setTimeout(a,t.threshold)},threshold:150}}(jQuery);var Path={version:"0.8.4",map:function(e){return Path.routes.defined.hasOwnProperty(e)?Path.routes.defined[e]:new Path.core.route(e)},root:function(e){Path.routes.root=e},rescue:function(e){Path.routes.rescue=e},history:{initial:{},pushState:function(e,t,i){Path.history.supported?Path.dispatch(i)&&history.pushState(e,t,i):Path.history.fallback&&(window.location.hash="#"+i)},popState:function(){var e=!Path.history.initial.popped&&location.href==Path.history.initial.URL;Path.history.initial.popped=!0,e||Path.dispatch(document.location.pathname)},listen:function(e){if(Path.history.supported=!(!window.history||!window.history.pushState),Path.history.fallback=e,Path.history.supported)Path.history.initial.popped="state"in window.history,Path.history.initial.URL=location.href,window.onpopstate=Path.history.popState;else if(Path.history.fallback){for(route in Path.routes.defined)"#"!=route.charAt(0)&&(Path.routes.defined["#"+route]=Path.routes.defined[route],Path.routes.defined["#"+route].path="#"+route);Path.listen()}}},match:function(e,t){var i,n,o,r,s,a={},l=null;for(l in Path.routes.defined)if(null!==l&&void 0!==l)for(l=Path.routes.defined[l],i=l.partition(),r=0;r<i.length;r++){if(n=i[r],s=e,n.search(/:/)>0)for(o=0;o<n.split("/").length;o++)o<s.split("/").length&&":"===n.split("/")[o].charAt(0)&&(a[n.split("/")[o].replace(/:/,"")]=s.split("/")[o],s=s.replace(s.split("/")[o],n.split("/")[o]));if(n===s)return t&&(l.params=a),l}return null},dispatch:function(e){var t,i;if(Path.routes.current!==e){if(Path.routes.previous=Path.routes.current,Path.routes.current=e,i=Path.match(e,!0),Path.routes.previous&&(t=Path.match(Path.routes.previous),null!==t&&null!==t.do_exit&&t.do_exit()),null!==i)return i.run(),!0;null!==Path.routes.rescue&&Path.routes.rescue()}},listen:function(){var e=function(){Path.dispatch(location.hash)};""===location.hash&&null!==Path.routes.root&&(location.hash=Path.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=e:setInterval(e,50),""!==location.hash&&Path.dispatch(location.hash)},core:{route:function(e){this.path=e,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},Path.routes.defined[e]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};Path.core.route.prototype={to:function(e){return this.action=e,this},enter:function(e){return e instanceof Array?this.do_enter=this.do_enter.concat(e):this.do_enter.push(e),this},exit:function(e){return this.do_exit=e,this},partition:function(){for(var e,t,i=[],n=[],o=/\(([^}]+?)\)/g;e=o.exec(this.path);)i.push(e[1]);for(n.push(this.path.split("(")[0]),t=0;t<i.length;t++)n.push(n[n.length-1]+i[t]);return n},run:function(){var e,t,i=!1;if(Path.routes.defined[this.path].hasOwnProperty("do_enter")&&Path.routes.defined[this.path].do_enter.length>0)for(e=0;e<Path.routes.defined[this.path].do_enter.length;e++)if(t=Path.routes.defined[this.path].do_enter[e].apply(this,null),t===!1){i=!0;break}i||Path.routes.defined[this.path].action()}},function(e,t){if("object"==typeof exports&&exports)t(exports);else{var i={};t(i),"function"==typeof define&&define.amd?define(i):e.Mustache=i}}(this,function(e){function t(e,t){return p.call(e,t)}function i(e){return!t(m,e)}function n(e){return"function"==typeof e}function o(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e){return String(e).replace(/[&<>"'\/]/g,function(e){return v[e]})}function s(e){if(!g(e)||2!==e.length)throw new Error("Invalid tags: "+e);return[new RegExp(o(e[0])+"\\s*"),new RegExp("\\s*"+o(e[1]))]}function a(t,n){function r(){if(_&&!P)for(;C.length;)delete E[C.pop()];else C=[];_=!1,P=!1}n=n||e.tags,t=t||"","string"==typeof n&&(n=n.split(y));for(var a,c,d,p,m,f,g=s(n),v=new u(t),T=[],E=[],C=[],_=!1,P=!1;!v.eos();){if(a=v.pos,d=v.scanUntil(g[0]))for(var O=0,M=d.length;M>O;++O)p=d.charAt(O),i(p)?C.push(E.length):P=!0,E.push(["text",p,a,a+1]),a+=1,"\n"===p&&r();if(!v.scan(g[0]))break;if(_=!0,c=v.scan(x)||"name",v.scan(w),"="===c?(d=v.scanUntil(S),v.scan(S),v.scanUntil(g[1])):"{"===c?(d=v.scanUntil(new RegExp("\\s*"+o("}"+n[1]))),v.scan(b),v.scanUntil(g[1]),c="&"):d=v.scanUntil(g[1]),!v.scan(g[1]))throw new Error("Unclosed tag at "+v.pos);if(m=[c,d,a,v.pos],E.push(m),"#"===c||"^"===c)T.push(m);else if("/"===c){if(f=T.pop(),!f)throw new Error('Unopened section "'+d+'" at '+a);if(f[1]!==d)throw new Error('Unclosed section "'+f[1]+'" at '+a)}else"name"===c||"{"===c||"&"===c?P=!0:"="===c&&(g=s(n=d.split(y)))}if(f=T.pop())throw new Error('Unclosed section "'+f[1]+'" at '+v.pos);return h(l(E))}function l(e){for(var t,i,n=[],o=0,r=e.length;r>o;++o)t=e[o],t&&("text"===t[0]&&i&&"text"===i[0]?(i[1]+=t[1],i[3]=t[3]):(n.push(t),i=t));return n}function h(e){for(var t,i,n=[],o=n,r=[],s=0,a=e.length;a>s;++s)switch(t=e[s],t[0]){case"#":case"^":o.push(t),r.push(t),o=t[4]=[];break;case"/":i=r.pop(),i[5]=t[2],o=r.length>0?r[r.length-1][4]:n;break;default:o.push(t)}return n}function u(e){this.string=e,this.tail=e,this.pos=0}function c(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function d(){this.cache={}}var p=RegExp.prototype.test,m=/\S/,f=Object.prototype.toString,g=Array.isArray||function(e){return"[object Array]"===f.call(e)},v={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},w=/\s*/,y=/\s+/,S=/\s*=/,b=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t=this.tail.match(e);if(t&&0===t.index){var i=t[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i}return""},u.prototype.scanUntil=function(e){var t,i=this.tail.search(e);switch(i){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=t.length,t},c.prototype.push=function(e){return new c(e,this)},c.prototype.lookup=function(e){var t;if(e in this.cache)t=this.cache[e];else{for(var i=this;i;){if(e.indexOf(".")>0){t=i.view;for(var o=e.split("."),r=0;null!=t&&r<o.length;)t=t[o[r++]]}else t=i.view[e];if(null!=t)break;i=i.parent}this.cache[e]=t}return n(t)&&(t=t.call(this.view)),t},d.prototype.clearCache=function(){this.cache={}},d.prototype.parse=function(e,t){var i=this.cache,n=i[e];return null==n&&(n=i[e]=a(e,t)),n},d.prototype.render=function(e,t,i){var n=this.parse(e),o=t instanceof c?t:new c(t);return this.renderTokens(n,o,i,e)},d.prototype.renderTokens=function(t,i,o,r){function s(e){return u.render(e,i,o)}for(var a,l,h="",u=this,c=0,d=t.length;d>c;++c)switch(a=t[c],a[0]){case"#":if(l=i.lookup(a[1]),!l)continue;if(g(l))for(var p=0,m=l.length;m>p;++p)h+=this.renderTokens(a[4],i.push(l[p]),o,r);else if("object"==typeof l||"string"==typeof l)h+=this.renderTokens(a[4],i.push(l),o,r);else if(n(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");l=l.call(i.view,r.slice(a[3],a[5]),s),null!=l&&(h+=l)}else h+=this.renderTokens(a[4],i,o,r);break;case"^":l=i.lookup(a[1]),(!l||g(l)&&0===l.length)&&(h+=this.renderTokens(a[4],i,o,r));break;case">":if(!o)continue;l=n(o)?o(a[1]):o[a[1]],null!=l&&(h+=this.renderTokens(this.parse(l),i,o,l));break;case"&":l=i.lookup(a[1]),null!=l&&(h+=l);break;case"name":l=i.lookup(a[1]),null!=l&&(h+=e.escape(l));break;case"text":h+=a[1]}return h},e.name="mustache.js",e.version="0.8.1",e.tags=["{{","}}"];var T=new d;e.clearCache=function(){return T.clearCache()},e.parse=function(e,t){return T.parse(e,t)},e.render=function(e,t,i){return T.render(e,t,i)},e.to_html=function(t,i,o,r){var s=e.render(t,i,o);return n(r)?void r(s):s},e.escape=r,e.Scanner=u,e.Context=c,e.Writer=d}),function(e,t){var i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(n){function o(){var t=e(d),i=e(p);l&&(p.length?l.reject(u,t,i):l.resolve(u)),e.isFunction(n)&&n.call(a,u,t,i)}function r(e){s(e.target,"error"===e.type)}function s(t,n){t.src===i||-1!==e.inArray(t,c)||(c.push(t),n?p.push(t):d.push(t),e.data(t,"imagesLoaded",{isBroken:n,src:t.src}),h&&l.notifyWith(e(t),[n,u,e(d),e(p)]),u.length===c.length&&(setTimeout(o),u.unbind(".imagesLoaded",r)))}var a=this,l=e.isFunction(e.Deferred)?e.Deferred():0,h=e.isFunction(l.notify),u=a.find("img").add(a.filter("img")),c=[],d=[],p=[];return e.isPlainObject(n)&&e.each(n,function(e,t){"callback"===e?n=t:l&&l[e](t)}),u.length?u.bind("load.imagesLoaded error.imagesLoaded",r).each(function(n,o){var r=o.src,a=e.data(o,"imagesLoaded");a&&a.src===r?s(o,a.isBroken):o.complete&&o.naturalWidth!==t?s(o,0===o.naturalWidth||0===o.naturalHeight):(o.readyState||o.complete)&&(o.src=i,o.src=r)}):o(),l?l.promise(a):a}}(jQuery),window.OpenSeadragon=window.OpenSeadragon||function(e){return new OpenSeadragon.Viewer(e)},function(e){e.version={versionStr:"1.0.0",major:1,minor:0,revision:0};var t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,n=Object.prototype.hasOwnProperty;e.isFunction=function(t){return"function"===e.type(t)},e.isArray=Array.isArray||function(t){return"array"===e.type(t)},e.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},e.type=function(e){return null===e||void 0===e?String(e):t[i.call(e)]||"object"},e.isPlainObject=function(t){if(!t||"object"!==OpenSeadragon.type(t)||t.nodeType||e.isWindow(t))return!1;if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1;var i;for(i in t);return void 0===i||n.call(t,i)},e.isEmptyObject=function(e){for(var t in e)return!1;return!0},e.supportsCanvas=function(){var t=document.createElement("canvas");return!(!e.isFunction(t.getContext)||!t.getContext("2d"))}()}(OpenSeadragon),function(e){function t(e,t){return t&&e!=document.body?document.body:e.offsetParent}e.extend=function(){var e,t,i,n,o,r,s=arguments[0]||{},a=arguments.length,l=!1,h=1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},h=2),"object"==typeof s||OpenSeadragon.isFunction(s)||(s={}),a===h&&(s=this,--h);a>h;h++)if(e=arguments[h],null!==e||void 0!==e)for(t in e)i=s[t],n=e[t],s!==n&&(l&&n&&(OpenSeadragon.isPlainObject(n)||(o=OpenSeadragon.isArray(n)))?(o?(o=!1,r=i&&OpenSeadragon.isArray(i)?i:[]):r=i&&OpenSeadragon.isPlainObject(i)?i:{},s[t]=OpenSeadragon.extend(l,r,n)):void 0!==n&&(s[t]=n));return s},e.extend(e,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,springStiffness:7,clickTimeThreshold:300,clickDistThreshold:5,zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,animationTime:1.2,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,pixelsPerWheelLine:40,autoResize:!0,showSequenceControl:!0,preserveViewport:!1,showNavigationControl:!0,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorHeight:null,navigatorWidth:null,navigatorPosition:null,navigatorSizeRatio:.2,degrees:0,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},navPrevNextWrap:!1,debugMode:!1,debugGridColor:"#437AB2"},SIGNAL:"----seadragon----",delegate:function(e,t){return function(){var i=arguments;return void 0===i&&(i=[]),t.apply(e,i)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(i){var n,o,r=new e.Point;for(i=e.getElement(i),n="fixed"==e.getElementStyle(i).position,o=t(i,n);o;)r.x+=i.offsetLeft,r.y+=i.offsetTop,n&&(r=r.plus(e.getPageScroll())),i=o,n="fixed"==e.getElementStyle(i).position,o=t(i,n);return r},getElementOffset:function(t){t=e.getElement(t);var i,n,o=t&&t.ownerDocument,r={top:0,left:0};return o?(i=o.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(r=t.getBoundingClientRect()),n=o==o.window?o:9===o.nodeType?o.defaultView||o.parentWindow:!1,new e.Point(r.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0),r.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0))):new e.Point},getElementSize:function(t){return t=e.getElement(t),new e.Point(t.clientWidth,t.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(t){return t=e.getElement(t),t.currentStyle}:function(t){return t=e.getElement(t),window.getComputedStyle(t,"")},getEvent:function(t){return e.getEvent=t?function(e){return e}:function(){return window.event},e.getEvent(t)},getMousePosition:function(t){if("number"==typeof t.pageX)e.getMousePosition=function(t){var i=new e.Point;return t=e.getEvent(t),i.x=t.pageX,i.y=t.pageY,i};else{if("number"!=typeof t.clientX)throw new Error("Unknown event mouse position, no known technique.");e.getMousePosition=function(t){var i=new e.Point;return t=e.getEvent(t),i.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop,i}}return e.getMousePosition(t)},getPageScroll:function(){var t=document.documentElement||{},i=document.body||{};if("number"==typeof window.pageXOffset)e.getPageScroll=function(){return new e.Point(window.pageXOffset,window.pageYOffset)};else if(i.scrollLeft||i.scrollTop)e.getPageScroll=function(){return new e.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!t.scrollLeft&&!t.scrollTop)return new e.Point(0,0);e.getPageScroll=function(){return new e.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return e.getPageScroll()},setPageScroll:function(t){if("undefined"!=typeof window.scrollTo)e.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var i=e.getPageScroll();if(i.x===t.x&&i.y===t.y)return;document.body.scrollLeft=t.x,document.body.scrollTop=t.y;var n=e.getPageScroll();if(n.x!==i.x&&n.y!==i.y)return void(e.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=t.x,document.documentElement.scrollTop=t.y,n=e.getPageScroll(),n.x!==i.x&&n.y!==i.y)return void(e.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});e.setPageScroll=function(){}}return e.setPageScroll(t)},getWindowSize:function(){var t=document.documentElement||{},i=document.body||{};if("number"==typeof window.innerWidth)e.getWindowSize=function(){return new e.Point(window.innerWidth,window.innerHeight)};else if(t.clientWidth||t.clientHeight)e.getWindowSize=function(){return new e.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!i.clientWidth&&!i.clientHeight)throw new Error("Unknown window size, no known technique.");e.getWindowSize=function(){return new e.Point(document.body.clientWidth,document.body.clientHeight)}}return e.getWindowSize()},makeCenteredNode:function(t){t=e.getElement(t);var i=[e.makeNeutralElement("div"),e.makeNeutralElement("div"),e.makeNeutralElement("div")];return e.extend(i[0].style,{display:"table",height:"100%",width:"100%"}),e.extend(i[1].style,{display:"table-row"}),e.extend(i[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),i[0].appendChild(i[1]),i[1].appendChild(i[2]),i[2].appendChild(t),i[0]},makeNeutralElement:function(e){var t=document.createElement(e),i=t.style;return i.background="transparent none",i.border="none",i.margin="0px",i.padding="0px",i.position="static",t},now:function(){return e.now=Date.now?Date.now:function(){return(new Date).getTime()},e.now()},makeTransparentImage:function(t){return e.makeTransparentImage=function(t){var i=e.makeNeutralElement("img");return i.src=t,i},e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<7&&(e.makeTransparentImage=function(t){var i=e.makeNeutralElement("img"),n=null;return n=e.makeNeutralElement("span"),n.style.display="inline-block",i.onload=function(){n.style.width=n.style.width||i.width+"px",n.style.height=n.style.height||i.height+"px",i.onload=null,i=null},i.src=t,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')",n}),e.makeTransparentImage(t)},setElementOpacity:function(t,i,n){var o,r;t=e.getElement(t),n&&!e.Browser.alpha&&(i=Math.round(i)),e.Browser.opacity?t.style.opacity=1>i?i:"":1>i?(o=Math.round(100*i),r="alpha(opacity="+o+")",t.style.filter=r):t.style.filter=""},addClass:function(t,i){t=e.getElement(t),t.className?-1===(" "+t.className+" ").indexOf(" "+i+" ")&&(t.className+=" "+i):t.className=i},removeClass:function(t,i){var n,o,r=[];for(t=e.getElement(t),n=t.className.split(/\s+/),o=0;o<n.length;o++)n[o]&&n[o]!==i&&r.push(n[o]);t.className=r.join(" ")},addEvent:function(){if(window.addEventListener)return function(t,i,n,o){t=e.getElement(t),t.addEventListener(i,n,o)};if(window.attachEvent)return function(t,i,n,o){t=e.getElement(t),t.attachEvent("on"+i,n),o&&t.setCapture&&t.setCapture()};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(t,i,n,o){t=e.getElement(t),t.removeEventListener(i,n,o)};if(window.detachEvent)return function(t,i,n,o){t=e.getElement(t),t.detachEvent("on"+i,n),o&&t.releaseCapture&&t.releaseCapture()};throw new Error("No known event model.")}(),cancelEvent:function(t){t=e.getEvent(t),e.cancelEvent=t.preventDefault?function(e){e.preventDefault()}:function(t){t=e.getEvent(t),t.cancel=!0,t.returnValue=!1},e.cancelEvent(t)},stopEvent:function(t){t=e.getEvent(t),e.stopEvent=t.stopPropagation?function(e){e.stopPropagation()}:function(t){t=e.getEvent(t),t.cancelBubble=!0},e.stopEvent(t)},createCallback:function(e,t){var i,n=[];
for(i=2;i<arguments.length;i++)n.push(arguments[i]);return function(){var i,o=n.concat([]);for(i=0;i<arguments.length;i++)o.push(arguments[i]);return t.apply(e,o)}},getUrlParameter:function(e){var t=o[e];return t?t:null},createAjaxRequest:function(){var t;if(window.XMLHttpRequest)e.createAjaxRequest=function(){return new XMLHttpRequest},t=new XMLHttpRequest;else if(window.ActiveXObject)for(var n=0;n<i.length;n++)try{t=new ActiveXObject(i[n]),e.createAjaxRequest=function(){return new ActiveXObject(i[n])};break}catch(o){continue}if(!t)throw new Error("Browser doesn't support XMLHttpRequest.");return t},makeAjaxRequest:function(t,i,n){var o=e.createAjaxRequest();if(!e.isFunction(i))throw new Error("makeAjaxRequest requires a success callback");o.onreadystatechange=function(){4==o.readyState&&(o.onreadystatechange=function(){},200==o.status?i(o):(e.console.log("AJAX request returned %s: %s",o.status,t),e.isFunction(n)&&n(o)))};try{o.open("GET",t,!0),o.send(null)}catch(r){var s=r.message,a=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<10;a&&"undefined"!=typeof r.number&&-2147024891==r.number&&(s+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),e.console.log("%s while making AJAX request: %s",r.name,s),o.onreadystatechange=function(){},e.isFunction(n)&&n(o,r)}},jsonp:function(t){var i,n=t.url,o=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=t.callbackName||"openseadragon"+e.now(),s=window[r],a="$1"+r+"$2",l=t.param||"callback",h=t.callback;n=n.replace(/(\=)\?(&|$)|\?\?/i,a),n+=(/\?/.test(n)?"&":"?")+l+"="+r,window[r]=function(t){if(s)window[r]=s;else try{delete window[r]}catch(i){}h&&e.isFunction(h)&&h(t)},i=document.createElement("script"),(void 0!==t.async||!1!==t.async)&&(i.async="async"),t.scriptCharset&&(i.charset=t.scriptCharset),i.src=n,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,o&&i.parentNode&&o.removeChild(i),i=void 0)},o.insertBefore(i,o.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(t){if(window.ActiveXObject)e.parseXml=function(e){var t=null;return t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e),t};else{if(!window.DOMParser)throw new Error("Browser doesn't support XML DOM.");e.parseXml=function(e){var t,i=null;return t=new DOMParser,i=t.parseFromString(e,"text/xml")}}return e.parseXml(t)},imageFormatSupported:function(e){return e=e?e:"",!!n[e.toLowerCase()]}}),e.Browser={vendor:e.BROWSERS.UNKNOWN,version:0,alpha:!0};var i=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],n={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},o={};!function(){var t=(navigator.appName,navigator.appVersion),i=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&(e.Browser.vendor=e.BROWSERS.IE,e.Browser.version=parseFloat(i.substring(i.indexOf("MSIE")+5,i.indexOf(";",i.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(i.indexOf("Firefox")>=0?(e.Browser.vendor=e.BROWSERS.FIREFOX,e.Browser.version=parseFloat(i.substring(i.indexOf("Firefox")+8))):i.indexOf("Safari")>=0&&(e.Browser.vendor=i.indexOf("Chrome")>=0?e.BROWSERS.CHROME:e.BROWSERS.SAFARI,e.Browser.version=parseFloat(i.substring(i.substring(0,i.indexOf("Safari")).lastIndexOf("/")+1,i.indexOf("Safari")))));break;case"Opera":e.Browser.vendor=e.BROWSERS.OPERA,e.Browser.version=parseFloat(t)}var n,r,s,a=window.location.search.substring(1),l=a.split("&");for(s=0;s<l.length;s++)n=l[s],r=n.indexOf("="),r>0&&(o[n.substring(0,r)]=decodeURIComponent(n.substring(r+1)));e.Browser.alpha=!(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9||e.Browser.vendor==e.BROWSERS.CHROME&&e.Browser.version<2),e.Browser.opacity=!(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9)}();var r=function(){};e.console=window.console||{log:r,debug:r,info:r,warn:r,error:r},function(t){var i=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame,n=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||t.msCancelAnimationFrame;if(i&&n)e.requestAnimationFrame=function(){return i.apply(t,arguments)},e.cancelAnimationFrame=function(){return n.apply(t,arguments)};else{var o,r=[],s=[],a=0;e.requestAnimationFrame=function(t){return r.push([++a,t]),o||(o=setInterval(function(){if(r.length){var t=e.now(),i=s;for(s=r,r=i;s.length;)s.shift()[1](t)}else clearInterval(o),o=void 0},20)),a},e.cancelAnimationFrame=function(e){var t,i;for(t=0,i=r.length;i>t;t+=1)if(r[t][0]===e)return void r.splice(t,1);for(t=0,i=s.length;i>t;t+=1)if(s[t][0]===e)return void s.splice(t,1)}}}(window),e._processDZIError=function(e){var t=e.getElementsByTagName("Message")[0],i=t.firstChild.nodeValue;throw new Error(i)}}(OpenSeadragon),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:"",prefix:""},i="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)t.supportsFullScreen=!0;else for(var n=0,o=i.length;o>n;n++)if(t.prefix=i[n],"undefined"!=typeof document[t.prefix+"CancelFullScreen"]){t.supportsFullScreen=!0;break}t.supportsFullScreen?(t.fullScreenEventName=t.prefix+"fullscreenchange",t.fullScreenErrorEventName=t.prefix+"fullscreenerror",t.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},t.requestFullScreen=function(e){return""===this.prefix?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()},t.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}):"undefined"!=typeof window.ActiveXObject&&(t.requestFullScreen=function(){var e=new ActiveXObject("WScript.Shell");return null!==e&&e.SendKeys("{F11}"),!1},t.cancelFullScreen=t.requestFullScreen),e.extend(e,t)}(OpenSeadragon),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addHandler:function(t,i,n){var o=this.events[t];o||(this.events[t]=o=[]),i&&e.isFunction(i)&&(o[o.length]={handler:i,userData:n||null})},removeHandler:function(t,i){var n,o=this.events[t],r=[];if(o&&e.isArray(o)){for(n=0;n<o.length;n++)o[n].handler!==i&&r.push(o[n]);this.events[t]=r}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var t=this.events[e];return t&&t.length?(t=1===t.length?[t[0]]:Array.apply(null,t),function(e,i){var n,o=t.length;for(n=0;o>n;n++)t[n]&&(i.eventSource=e,i.userData=t[n].userData,t[n].handler(i))}):null},raiseEvent:function(e,t){var i=this.getHandler(e);i&&(t||(t={}),i(this,t))}}}(OpenSeadragon),function(e){function t(t){var i,n,o=["mouseover","mouseout","mousedown","mouseup","mousemove","click",e.MouseTracker.wheelEventName,"touchstart","touchmove","touchend","keypress","focus","blur"],r=A[t.hash];if("DOMMouseScroll"==e.MouseTracker.wheelEventName&&o.push("MozMousePixelScroll"),!r.tracking){for(n=0;n<o.length;n++)i=o[n],e.addEvent(t.element,i,r[i],!1);r.tracking=!0,B[t.hash]=t}}function i(t){var i,n,o=["mouseover","mouseout","mousedown","mouseup","mousemove","click",e.MouseTracker.wheelEventName,"touchstart","touchmove","touchend","keypress","focus","blur"],s=A[t.hash];if("DOMMouseScroll"==e.MouseTracker.wheelEventName&&o.push("MozMousePixelScroll"),s.tracking){for(n=0;n<o.length;n++)i=o[n],e.removeEvent(t.element,i,s[i],!1);r(t),s.tracking=!1,delete B[t.hash]}}function n(e){return A[e.hash].insideElement}function o(t){var i=A[t.hash];i.capturing||(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9?(e.removeEvent(t.element,"mouseup",i.mouseup,!1),e.addEvent(t.element,"mouseup",i.mouseupie,!0),e.addEvent(t.element,"mousemove",i.mousemovecapturedie,!0)):(e.addEvent(window,"mouseup",i.mouseupcaptured,!0),e.addEvent(window,"mousemove",i.mousemovecaptured,!0)),i.capturing=!0)}function r(t){var i=A[t.hash];i.capturing&&(e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9?(e.removeEvent(t.element,"mousemove",i.mousemovecapturedie,!0),e.removeEvent(t.element,"mouseup",i.mouseupie,!0),e.addEvent(t.element,"mouseup",i.mouseup,!1)):(e.removeEvent(window,"mousemove",i.mousemovecaptured,!0),e.removeEvent(window,"mouseup",i.mouseupcaptured,!0)),i.capturing=!1)}function s(e,t,i,n){var o;for(o in B)B.hasOwnProperty(o)&&e.hash!=o&&t(B[o],i,n)}function a(t,i){var n;t.focusHandler&&(n=t.focusHandler({eventSource:t,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n===!1&&e.cancelEvent(i))}function l(t,i){var n;t.blurHandler&&(n=t.blurHandler({eventSource:t,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n===!1&&e.cancelEvent(i))}function h(t,i){var n;t.keyHandler&&(n=t.keyHandler({eventSource:t,position:M(i,t.element),keyCode:i.keyCode?i.keyCode:i.charCode,shift:i.shiftKey,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),n||e.cancelEvent(i))}function u(t,i,n){var o,r=A[t.hash];if(n=n||!1,i=e.getEvent(i),!n){e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9&&r.capturing&&!k(i.srcElement,t.element)&&s(t,u,i,n);var a=i.target?i.target:i.srcElement,l=i.relatedTarget?i.relatedTarget:i.fromElement;if(!k(t.element,a)||k(t.element,l))return}r.insideElement=!0,t.enterHandler&&(o=t.enterHandler({eventSource:t,position:M(n?i.changedTouches[0]:i,t.element),insideElementPressed:r.insideElementPressed,buttonDownAny:D,isTouchEvent:n,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),o===!1&&e.cancelEvent(i))}function c(t,i,n){var o,r=A[t.hash];if(n=n||!1,i=e.getEvent(i),!n){e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9&&r.capturing&&!k(i.srcElement,t.element)&&s(t,c,i,n);var a=i.target?i.target:i.srcElement,l=i.relatedTarget?i.relatedTarget:i.toElement;if(!k(t.element,a)||k(t.element,l))return}r.insideElement=!1,t.exitHandler&&(o=t.exitHandler({eventSource:t,position:M(n?i.changedTouches[0]:i,t.element),insideElementPressed:r.insideElementPressed,buttonDownAny:D,isTouchEvent:n,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),o===!1&&e.cancelEvent(i))}function d(t,i,n,r){var s,a=A[t.hash];r=r||!1,i=e.getEvent(i);var l=r?i.touches[0]:i;2!=i.button&&(a.insideElementPressed=!0,a.lastPoint=O(l),a.lastMouseDownPoint=a.lastPoint,a.lastMouseDownTime=e.now(),t.pressHandler&&(s=t.pressHandler({eventSource:t,position:M(l,t.element),isTouchEvent:r,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),s===!1&&e.cancelEvent(i)),(t.pressHandler||t.dragHandler)&&e.cancelEvent(i),n||(!r&&e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9&&z?e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9&&H.push(t):(o(t),z=!0,H=[t])))}function p(t,i){var n,o;1==i.touches.length&&1==i.targetTouches.length&&1==i.changedTouches.length&&(A[t.hash].lastTouch=i.touches[0],u(t,i,!0),d(t,i,!0,!0)),2==i.touches.length&&(n=O(i.touches[0]),o=O(i.touches[1]),A[t.hash].lastPinchDelta=Math.abs(n.x-o.x)+Math.abs(n.y-o.y),A[t.hash].pinchMidpoint=new e.Point((n.x+o.x)/2,(n.y+o.y)/2)),i.preventDefault()}function m(t,i,n){var o,r=A[t.hash],s=r.insideElementPressed,a=r.insideElement;n=n||!1,i=e.getEvent(i),2!=i.button&&(r.insideElementPressed=!1,t.releaseHandler&&(o=t.releaseHandler({eventSource:t,position:M(n?i.changedTouches[0]:i,t.element),insideElementPressed:s,insideElementReleased:a,isTouchEvent:n,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),o===!1&&e.cancelEvent(i)),s&&a&&E(t,i,n))}function f(e,t){0===t.touches.length&&0===t.targetTouches.length&&1==t.changedTouches.length&&(A[e.hash].lastTouch=null,v(e,t,!0,!0),c(e,t,!0)),t.touches.length+t.changedTouches.length==2&&(A[e.hash].lastPinchDelta=null,A[e.hash].pinchMidpoint=null),t.preventDefault()}function g(t,i){var o,s;if(i=e.getEvent(i),2!=i.button){for(s=0;s<H.length;s++)o=H[s],n(o)||m(o,i,!1);r(t),z=!1,i.srcElement.fireEvent("on"+i.type,document.createEventObject(i)),e.stopEvent(i)}}function v(e,t,i,n){n=n||!1,(!A[e.hash].insideElement||n)&&m(e,t,n),i||r(e)}function w(t,i){if(t.moveHandler){i=e.getEvent(i);var n=t.moveHandler({eventSource:t,position:M(i,t.element),isTouchEvent:!1,originalEvent:i,preventDefaultAction:!1,userData:t.userData});n===!1&&e.cancelEvent(i)}t.stopHandler&&(clearTimeout(t.stopTimeOut),t.stopTimeOut=setTimeout(function(){y(t,i)},t.stopDelay))}function y(e,t){e.stopHandler&&e.stopHandler({eventSource:e,position:M(t,e.element),isTouchEvent:!1,originalEvent:t,preventDefaultAction:!1,userData:e.userData})}function S(t,i){t.clickHandler&&e.cancelEvent(i)}function b(e,t){T(e,t,t,!1)}function x(t,i){i=i||window.event;var n={target:i.target||i.srcElement,type:"wheel",shiftKey:i.shiftKey||!1,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX?i.pageX:i.clientX,pageY:i.pageY?i.pageY:i.clientY,deltaMode:"MozMousePixelScroll"==i.type?0:1,deltaX:0,deltaZ:0};n.deltaY="mousewheel"==e.MouseTracker.wheelEventName?-1/e.DEFAULT_SETTINGS.pixelsPerWheelLine*i.wheelDelta:i.detail,T(t,n,i,!1)}function T(t,i,n,o){var r,s=0;o=o||!1,s=i.deltaY<0?1:-1,t.scrollHandler&&(r=t.scrollHandler({eventSource:t,position:M(i,t.element),scroll:s,shift:i.shiftKey,isTouchEvent:o,originalEvent:n,preventDefaultAction:!1,userData:t.userData}),r===!1&&e.cancelEvent(n))}function E(t,i,n){var o,r=A[t.hash];n=n||!1,i=e.getEvent(i);var s=n?i.changedTouches[0]:i;if(2!=i.button){var a=e.now()-r.lastMouseDownTime,l=O(s),h=r.lastMouseDownPoint.distanceTo(l),u=a<=t.clickTimeThreshold&&h<=t.clickDistThreshold;t.clickHandler&&(o=t.clickHandler({eventSource:t,position:M(s,t.element),quick:u,shift:i.shiftKey,isTouchEvent:n,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),o===!1&&e.cancelEvent(i))}}function C(t,i,n){var o,r,s,a=A[t.hash];n=n||!1,i=e.getEvent(i);var l=n?i.touches[0]:i;s=O(l),o=s.minus(a.lastPoint),a.lastPoint=s,t.dragHandler&&(r=t.dragHandler({eventSource:t,position:M(l,t.element),delta:o,shift:i.shiftKey,isTouchEvent:n,originalEvent:i,preventDefaultAction:!1,userData:t.userData}),r===!1&&e.cancelEvent(i))}function _(e,t){var i,n,o;if(A[e.hash].lastTouch){if(1===t.touches.length&&1===t.targetTouches.length&&1===t.changedTouches.length&&A[e.hash].lastTouch.identifier===t.touches[0].identifier)C(e,t,!0);else if(2===t.touches.length&&(i=O(t.touches[0]),n=O(t.touches[1]),o=Math.abs(i.x-n.x)+Math.abs(i.y-n.y),Math.abs(A[e.hash].lastPinchDelta-o)>75)){var r={target:t.target||t.srcElement,type:"wheel",shiftKey:t.shiftKey||!1,clientX:A[e.hash].pinchMidpoint.x,clientY:A[e.hash].pinchMidpoint.y,pageX:A[e.hash].pinchMidpoint.x,pageY:A[e.hash].pinchMidpoint.y,deltaMode:1,deltaX:0,deltaY:A[e.hash].lastPinchDelta>o?1:-1,deltaZ:0};T(e,r,t,!0),A[e.hash].lastPinchDelta=o}t.preventDefault()}}function P(t,i){var n;for(n=0;n<H.length;n++)C(H[n],i,!1);e.stopEvent(i)}function O(t){return e.getMousePosition(t)}function M(t,i){var n=e.getMousePosition(t),o=e.getElementOffset(i);return n.minus(o)}function k(e,t){for(var i=document.body;t&&e!=t&&i!=t;)try{t=t.parentNode}catch(n){return!1}return e==t}function I(){D=!0}function R(){D=!1}var D=!1,z=!1,B={},H=[],A={};e.MouseTracker=function(t){var i=arguments;e.isPlainObject(t)||(t={element:i[0],clickTimeThreshold:i[1],clickDistThreshold:i[2]}),this.hash=Math.random(),this.element=e.getElement(t.element),this.clickTimeThreshold=t.clickTimeThreshold,this.clickDistThreshold=t.clickDistThreshold,this.userData=t.userData||null,this.stopDelay=t.stopDelay||50,this.enterHandler=t.enterHandler||null,this.exitHandler=t.exitHandler||null,this.pressHandler=t.pressHandler||null,this.releaseHandler=t.releaseHandler||null,this.moveHandler=t.moveHandler||null,this.scrollHandler=t.scrollHandler||null,this.clickHandler=t.clickHandler||null,this.dragHandler=t.dragHandler||null,this.stopHandler=t.stopHandler||null,this.keyHandler=t.keyHandler||null,this.focusHandler=t.focusHandler||null,this.blurHandler=t.blurHandler||null;var n=this;A[this.hash]={mouseover:function(e){u(n,e,!1)},mouseout:function(e){c(n,e,!1)},mousedown:function(e){d(n,e)},mouseup:function(e){m(n,e,!1)},mousemove:function(e){w(n,e)},click:function(e){S(n,e)},wheel:function(e){b(n,e)},mousewheel:function(e){x(n,e)},DOMMouseScroll:function(e){x(n,e)},MozMousePixelScroll:function(e){x(n,e)},mouseupie:function(e){g(n,e)},mousemovecapturedie:function(e){P(n,e)},mouseupcaptured:function(e){v(n,e)},mousemovecaptured:function(e){C(n,e,!1)},touchstart:function(e){p(n,e)},touchmove:function(e){_(n,e)},touchend:function(e){f(n,e)},keypress:function(e){h(n,e)},focus:function(e){a(n,e)},blur:function(e){l(n,e)},tracking:!1,capturing:!1,insideElementPressed:!1,insideElement:!1,lastPoint:null,lastMouseDownTime:null,lastMouseDownPoint:null,lastPinchDelta:0}},e.MouseTracker.prototype={destroy:function(){i(this),this.element=null},isTracking:function(){return A[this.hash].tracking},setTracking:function(e){return e?t(this):i(this),this},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},releaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dragHandler:function(){},stopHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},e.MouseTracker.wheelEventName=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",function(){e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version<9?(e.addEvent(document,"mousedown",I,!1),e.addEvent(document,"mouseup",R,!1)):(e.addEvent(window,"mousedown",I,!0),e.addEvent(window,"mouseup",R,!0))}()}(OpenSeadragon),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4},e.Control=function(t,i,n){var o=t.parentNode;"number"==typeof i&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),i={anchor:i}),i.attachToViewer="undefined"==typeof i.attachToViewer?!0:i.attachToViewer,this.autoFade="undefined"==typeof i.autoFade?!0:i.autoFade,this.element=t,this.anchor=i.anchor,this.container=n,this.wrapper=e.makeNeutralElement("span"),this.wrapper.style.display="inline-block",this.wrapper.appendChild(this.element),this.anchor==e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%"),i.attachToViewer?this.anchor==e.ControlAnchor.TOP_RIGHT||this.anchor==e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?"inline-block":"none"},setOpacity:function(t){this.element[e.SIGNAL]&&e.Browser.vendor==e.BROWSERS.IE?e.setElementOpacity(this.element,t,!0):e.setElementOpacity(this.wrapper,t,!0)}}}(OpenSeadragon),function(e){function t(e,t){var i,n=e.controls;for(i=n.length-1;i>=0;i--)if(n[i].element==t)return i;return-1}e.ControlDock=function(t){var i,n,o=["topleft","topright","bottomright","bottomleft"];for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(1e6*Math.random()),container:e.makeNeutralElement("form"),controls:[]},t),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),n=0;n<o.length;n++)i=o[n],this.controls[i]=e.makeNeutralElement("div"),this.controls[i].style.position="absolute",i.match("left")&&(this.controls[i].style.left="0px"),i.match("right")&&(this.controls[i].style.right="0px"),i.match("top")&&(this.controls[i].style.top="0px"),i.match("bottom")&&(this.controls[i].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(i,n){i=e.getElement(i);var o=null;if(!(t(this,i)>=0)){switch(n.anchor){case e.ControlAnchor.TOP_RIGHT:o=this.controls.topright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,i.style.position="relative",i.style.paddingRight="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:o=this.controls.topleft,i.style.position="relative",i.style.paddingLeft="0px",i.style.paddingTop="0px";break;default:case e.ControlAnchor.NONE:o=this.container,i.style.margin="0px",i.style.padding="0px"}this.controls.push(new e.Control(i,n,o)),i.style.display="inline-block"}},removeControl:function(i){i=e.getElement(i);var n=t(this,i);return n>=0&&(this.controls[n].destroy(),this.controls.splice(n,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;e>=0;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;t>=0;t--)this.controls[t].setVisible(e);return this}}}(OpenSeadragon),function($){function _getSafeElemSize(e){return e=$.getElement(e),new $.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function openTileSource(e,t){var i,n,o=e;for(o.source&&o.close(),o.canvas.innerHTML="",THIS[o.hash].prevContainerSize=_getSafeElemSize(o.container),o.collectionMode?(o.source=new $.TileSourceCollection({rows:o.collectionRows,layout:o.collectionLayout,tileSize:o.collectionTileSize,tileSources:o.tileSources,tileMargin:o.collectionTileMargin}),o.viewport=o.viewport?o.viewport:new $.Viewport({collectionMode:!0,collectionTileSource:o.source,containerSize:THIS[o.hash].prevContainerSize,contentSize:o.source.dimensions,springStiffness:o.springStiffness,animationTime:o.animationTime,showNavigator:!1,minZoomImageRatio:1,maxZoomPixelRatio:1,viewer:o})):(t&&(o.source=t),o.viewport=o.viewport?o.viewport:new $.Viewport({containerSize:THIS[o.hash].prevContainerSize,contentSize:o.source.dimensions,springStiffness:o.springStiffness,animationTime:o.animationTime,minZoomImageRatio:o.minZoomImageRatio,maxZoomPixelRatio:o.maxZoomPixelRatio,visibilityRatio:o.visibilityRatio,wrapHorizontal:o.wrapHorizontal,wrapVertical:o.wrapVertical,defaultZoomLevel:o.defaultZoomLevel,minZoomLevel:o.minZoomLevel,maxZoomLevel:o.maxZoomLevel,viewer:o})),o.preserveViewport&&o.viewport.resetContentSize(o.source.dimensions),o.source.overlays=o.source.overlays||[],o.drawer=new $.Drawer({viewer:o,source:o.source,viewport:o.viewport,element:o.canvas,overlays:[].concat(o.overlays).concat(o.source.overlays),maxImageCacheCount:o.maxImageCacheCount,imageLoaderLimit:o.imageLoaderLimit,minZoomImageRatio:o.minZoomImageRatio,wrapHorizontal:o.wrapHorizontal,wrapVertical:o.wrapVertical,immediateRender:o.immediateRender,blendTime:o.blendTime,alwaysBlend:o.alwaysBlend,minPixelRatio:o.collectionMode?0:o.minPixelRatio,timeout:o.timeout,debugMode:o.debugMode,debugGridColor:o.debugGridColor}),o.showNavigator&&!o.collectionMode&&(o.navigator?o.navigator.open(t):o.navigator=new $.Navigator({id:o.navigatorId,position:o.navigatorPosition,sizeRatio:o.navigatorSizeRatio,height:o.navigatorHeight,width:o.navigatorWidth,tileSources:t,tileHost:o.tileHost,prefixUrl:o.prefixUrl,overlays:o.overlays,viewer:o})),o.showReferenceStrip&&!o.referenceStrip&&(o.referenceStrip=new $.ReferenceStrip({id:o.referenceStripElement,position:o.referenceStripPosition,sizeRatio:o.referenceStripSizeRatio,scroll:o.referenceStripScroll,height:o.referenceStripHeight,width:o.referenceStripWidth,tileSources:o.tileSources,tileHost:o.tileHost,prefixUrl:o.prefixUrl,overlays:o.overlays,viewer:o})),THIS[o.hash].animating=!1,THIS[o.hash].forceRedraw=!0,o._updateRequestId=scheduleUpdate(o,updateMulti),n=0;n<o.overlayControls.length;n++)i=o.overlayControls[n],i.point?o.drawer.addOverlay(i.id,new $.Point(i.point.X,i.point.Y),$.OverlayPlacement.TOP_LEFT):o.drawer.addOverlay(i.id,new $.Rect(i.rect.Point.X,i.rect.Point.Y,i.rect.Width,i.rect.Height),i.placement);return VIEWERS[o.hash]=o,o.raiseEvent("open",{source:t}),o}function scheduleUpdate(e,t){return $.requestAnimationFrame(function(){t(e)})}function scheduleControlsFade(e){$.requestAnimationFrame(function(){updateControlsFade(e)})}function beginControlsAutoHide(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=$.now()+e.controlsFadeDelay,window.setTimeout(function(){scheduleControlsFade(e)},e.controlsFadeDelay))}function updateControlsFade(e){var t,i,n,o;if(e.controlsShouldFade){for(t=$.now(),i=t-e.controlsFadeBeginTime,n=1-i/e.controlsFadeLength,n=Math.min(1,n),n=Math.max(0,n),o=e.controls.length-1;o>=0;o--)e.controls[o].autoFade&&e.controls[o].setOpacity(n);n>0&&scheduleControlsFade(e)}}function abortControlsAutoHide(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;t>=0;t--)e.controls[t].setOpacity(1)}function onFocus(){abortControlsAutoHide(this)}function onBlur(){beginControlsAutoHide(this)}function onCanvasClick(e){var t,i;!e.preventDefaultAction&&this.viewport&&e.quick&&(t=this.zoomPerClick,i=e.shift?1/t:t,this.viewport.zoomBy(i,this.viewport.pointFromPixel(e.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-click",{tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent})}function onCanvasDrag(e){!e.preventDefaultAction&&this.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate())),this.constrainDuringPan&&this.viewport.applyConstraints()),this.raiseEvent("canvas-drag",{tracker:e.eventSource,position:e.position,delta:e.delta,shift:e.shift,originalEvent:e.originalEvent})}function onCanvasRelease(e){e.insideElementPressed&&this.viewport&&this.viewport.applyConstraints(),this.raiseEvent("canvas-release",{tracker:e.eventSource,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function onCanvasScroll(e){var t;return!e.preventDefaultAction&&this.viewport&&(t=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(t,this.viewport.pointFromPixel(e.position,!0)),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function onContainerExit(e){e.insideElementPressed||(THIS[this.hash].mouseInside=!1,THIS[this.hash].animating||beginControlsAutoHide(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function onContainerRelease(e){e.insideElementReleased||(THIS[this.hash].mouseInside=!1,THIS[this.hash].animating||beginControlsAutoHide(this)),this.raiseEvent("container-release",{tracker:e.eventSource,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function onContainerEnter(e){THIS[this.hash].mouseInside=!0,abortControlsAutoHide(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function updateMulti(e){return e.source?(updateOnce(e),void(e.source&&(e._updateRequestId=scheduleUpdate(e,updateMulti)))):void(e._updateRequestId=null)}function updateOnce(e){var t,i;if(e.source){if(e.autoResize&&(t=_getSafeElemSize(e.container),!t.equals(THIS[e.hash].prevContainerSize))){var n=e.viewport.getBounds(),o=e.viewport.getCenter();resizeViewportAndRecenter(e,t,n,o),THIS[e.hash].prevContainerSize=t,THIS[e.hash].forceRedraw=!0}i=e.viewport.update(),e.referenceStrip&&(i=e.referenceStrip.update(e.viewport)||i),!THIS[e.hash].animating&&i&&(e.raiseEvent("animation-start"),abortControlsAutoHide(e)),i?(e.drawer.update(),e.navigator&&e.navigator.update(e.viewport),e.raiseEvent("animation")):(THIS[e.hash].forceRedraw||e.drawer.needsUpdate())&&(e.drawer.update(),e.navigator&&e.navigator.update(e.viewport),THIS[e.hash].forceRedraw=!1),THIS[e.hash].animating&&!i&&(e.raiseEvent("animation-finish"),THIS[e.hash].mouseInside||beginControlsAutoHide(e)),THIS[e.hash].animating=i}}function resizeViewportAndRecenter(e,t,i,n){var o=e.viewport;o.resize(t,!0);var r=1/e.source.aspectRatio,s=i.width<=1?i.width:1,a=i.height<=r?i.height:r,l=new $.Rect(n.x-s/2,n.y-a/2,s,a);o.fitBounds(l,!0)}function resolveUrl(e,t){return e?e+t:t}function beginZoomingIn(){THIS[this.hash].lastZoomTime=$.now(),THIS[this.hash].zoomFactor=this.zoomPerSecond,THIS[this.hash].zooming=!0,scheduleZoom(this)}function beginZoomingOut(){THIS[this.hash].lastZoomTime=$.now(),THIS[this.hash].zoomFactor=1/this.zoomPerSecond,THIS[this.hash].zooming=!0,scheduleZoom(this)}function endZooming(){THIS[this.hash].zooming=!1}function scheduleZoom(e){$.requestAnimationFrame($.delegate(e,doZoom))}function doZoom(){var e,t,i;THIS[this.hash].zooming&&this.viewport&&(e=$.now(),t=e-THIS[this.hash].lastZoomTime,i=Math.pow(THIS[this.hash].zoomFactor,t/1e3),this.viewport.zoomBy(i),this.viewport.applyConstraints(),THIS[this.hash].lastZoomTime=e,scheduleZoom(this))}function doSingleZoomIn(){this.viewport&&(THIS[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function doSingleZoomOut(){this.viewport&&(THIS[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function lightUp(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function onHome(){this.viewport&&this.viewport.goHome()}function onFullScreen(){this.isFullPage()&&!$.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function onPrevious(){var e=THIS[this.hash].sequence-1;this.navPrevNextWrap&&0>e&&(e+=this.tileSources.length),this.goToPage(e)}function onNext(){var e=THIS[this.hash].sequence+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}var THIS={},VIEWERS={};$.Viewer=function(e){var t,i=arguments,n=this;if($.isPlainObject(e)||(e={id:i[0],xmlPath:i.length>1?i[1]:void 0,prefixUrl:i.length>2?i[2]:void 0,controls:i.length>3?i[3]:void 0,overlays:i.length>4?i[4]:void 0,overlayControls:i.length>5?i[5]:void 0}),e.config&&($.extend(!0,e,e.config),delete e.config),$.extend(!0,this,{id:e.id,hash:e.hash||e.id,element:null,container:null,keyboardCommandArea:null,canvas:null,overlays:[],overlayControls:[],previousBody:[],customControls:[],source:null,drawer:null,drawers:[],viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},$.DEFAULT_SETTINGS,e),"undefined"==typeof this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");"undefined"!=typeof THIS[this.hash]&&$.console.warn("Hash "+this.hash+" has already been used."),THIS[this.hash]={fsBoundsDelta:new $.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,sequenced:!1,sequence:0,fullPage:!1,onfullscreenchange:null},this._updateRequestId=null,$.EventSource.call(this),this.addHandler("open-failed",function(e){var t=$.getString("Errors.OpenFailed",e.eventSource,e.message);
n._showMessage(t)}),$.ControlDock.call(this,e);var o;for(this.xmlPath&&(this.tileSources=[this.xmlPath]),this.tileSources&&($.isArray(this.tileSources)?(this.tileSources.length>1&&(THIS[this.hash].sequenced=!0),this.initialPage>this.tileSources.length-1&&(this.initialPage=this.tileSources.length-1),o=this.tileSources[this.initialPage],THIS[this.hash].sequence=this.initialPage):o=this.tileSources),this.element=this.element||document.getElementById(this.id),this.canvas=$.makeNeutralElement("div"),this.keyboardCommandArea=$.makeNeutralElement("textarea"),this.canvas.className="openseadragon-canvas",function(e){e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px"}(this.canvas.style),this.container.className="openseadragon-container",function(e){e.width="100%",e.height="100%",e.position="relative",e.overflow="hidden",e.left="0px",e.top="0px",e.textAlign="left"}(this.container.style),this.keyboardCommandArea.className="keyboard-command-area",function(e){e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px",e.resize="none"}(this.keyboardCommandArea.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.container.insertBefore(this.keyboardCommandArea,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.keyboardCommandArea.innerTracker=new $.MouseTracker({_this:this,element:this.keyboardCommandArea,focusHandler:function(e){if(!e.preventDefaultAction){var t=$.getElementPosition(this.element);window.scrollTo(0,t.y)}},keyHandler:function(e){if(!e.preventDefaultAction)switch(e.keyCode){case 61:return n.viewport.zoomBy(1.1),n.viewport.applyConstraints(),!1;case 45:return n.viewport.zoomBy(.9),n.viewport.applyConstraints(),!1;case 48:return n.viewport.goHome(),n.viewport.applyConstraints(),!1;case 119:case 87:case 38:return e.shift?n.viewport.zoomBy(1.1):n.viewport.panBy(new $.Point(0,-.05)),n.viewport.applyConstraints(),!1;case 115:case 83:case 40:return e.shift?n.viewport.zoomBy(.9):n.viewport.panBy(new $.Point(0,.05)),n.viewport.applyConstraints(),!1;case 97:case 37:return n.viewport.panBy(new $.Point(-.05,0)),n.viewport.applyConstraints(),!1;case 100:case 39:return n.viewport.panBy(new $.Point(.05,0)),n.viewport.applyConstraints(),!1;default:return!0}}}).setTracking(!0),this.innerTracker=new $.MouseTracker({element:this.canvas,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,clickHandler:$.delegate(this,onCanvasClick),dragHandler:$.delegate(this,onCanvasDrag),releaseHandler:$.delegate(this,onCanvasRelease),scrollHandler:$.delegate(this,onCanvasScroll)}).setTracking(this.mouseNavEnabled?!0:!1),this.outerTracker=new $.MouseTracker({element:this.container,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:$.delegate(this,onContainerEnter),exitHandler:$.delegate(this,onContainerExit),releaseHandler:$.delegate(this,onContainerRelease)}).setTracking(this.mouseNavEnabled?!0:!1),this.toolbar&&(this.toolbar=new $.ControlDock({element:this.toolbar})),this.bindStandardControls(),this.bindSequenceControls(),o&&(this.open(o),this.tileSources.length>1&&this._updateSequenceButtons(this.initialPage)),t=0;t<this.customControls.length;t++)this.addControl(this.customControls[t].id,{anchor:this.customControls[t].anchor});$.requestAnimationFrame(function(){beginControlsAutoHide(n)})},$.extend($.Viewer.prototype,$.EventSource.prototype,$.ControlDock.prototype,{isOpen:function(){return!!this.source},openDzi:function(e){return this.open(e)},openTileSource:function(e){return this.open(e)},open:function(tileSource){var _this=this,customTileSource,readySource,$TileSource,options;return _this._hideMessage(),"string"==$.type(tileSource)&&(tileSource.match(/\s*<.*/)?tileSource=$.parseXml(tileSource):tileSource.match(/\s*[\{\[].*/)&&(tileSource=eval("("+tileSource+")"))),setTimeout(function(){if("string"==$.type(tileSource))tileSource=new $.TileSource(tileSource,function(e){openTileSource(_this,e.tileSource)}),tileSource.addHandler("open-failed",function(e){_this.raiseEvent("open-failed",e)});else if($.isPlainObject(tileSource)||tileSource.nodeType)if($.isFunction(tileSource.getTileUrl))customTileSource=new $.TileSource(tileSource),customTileSource.getTileUrl=tileSource.getTileUrl,openTileSource(_this,customTileSource);else{if($TileSource=$.TileSource.determineType(_this,tileSource),!$TileSource)return void _this.raiseEvent("open-failed",{message:"Unable to load TileSource",source:tileSource});options=$TileSource.prototype.configure.apply(_this,[tileSource]),readySource=new $TileSource(options),openTileSource(_this,readySource)}else openTileSource(_this,tileSource)},1),this},close:function(){return null!==this._updateRequestId&&($.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.navigator&&this.navigator.close(),this.drawer&&this.drawer.clearOverlays(),this.source=null,this.drawer=null,this.viewport=this.preserveViewport?this.viewport:null,this.canvas&&(this.canvas.innerHTML=""),VIEWERS[this.hash]=null,delete VIEWERS[this.hash],this.raiseEvent("close"),this},destroy:function(){if(this.close(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.keyboardCommandArea&&this.keyboardCommandArea.innerTracker.destroy(),this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),this.canvas=null,this.keyboardCommandArea=null,this.container=null,this.element=null},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisibile();return t},setControlsEnabled:function(e){return e?abortControlsAutoHide(this):beginControlsAutoHide(this),this.raiseEvent("controls-enabled",{enabled:e}),this},isFullPage:function(){return THIS[this.hash].fullPage},setFullPage:function(e){var t,i,n=document.body,o=n.style,r=document.documentElement.style,s=this;if(e==this.isFullPage())return this;var a={fullPage:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",a),a.preventDefaultAction)return this;if(e){for(this.elementSize=$.getElementSize(this.element),this.pageScroll=$.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=o.margin,this.docMargin=r.margin,o.margin="0",r.margin="0",this.bodyPadding=o.padding,this.docPadding=r.padding,o.padding="0",r.padding="0",this.bodyWidth=o.width,this.bodyHeight=o.height,o.width="100%",o.height="100%",this.previousBody=[],THIS[this.hash].prevElementParent=this.element.parentNode,THIS[this.hash].prevNextSibling=this.element.nextSibling,THIS[this.hash].prevElementWidth=this.element.style.width,THIS[this.hash].prevElementHeight=this.element.style.height,t=n.childNodes.length,i=0;t>i;i++)this.previousBody.push(n.childNodes[0]),n.removeChild(n.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,n.appendChild(this.toolbar.element),$.addClass(this.toolbar.element,"fullpage")),$.addClass(this.element,"fullpage"),n.appendChild(this.element),this.element.style.height=$.getWindowSize().y+"px",this.element.style.width=$.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=$.getElementSize(this.element).y-$.getElementSize(this.toolbar.element).y+"px"),THIS[this.hash].fullPage=!0,$.delegate(this,onContainerEnter)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,o.margin=this.bodyMargin,r.margin=this.docMargin,o.padding=this.bodyPadding,r.padding=this.docPadding,o.width=this.bodyWidth,o.height=this.bodyHeight,n.removeChild(this.element),t=this.previousBody.length,i=0;t>i;i++)n.appendChild(this.previousBody.shift());$.removeClass(this.element,"fullpage"),THIS[this.hash].prevElementParent.insertBefore(this.element,THIS[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(n.removeChild(this.toolbar.element),$.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=THIS[this.hash].prevElementWidth,this.element.style.height=THIS[this.hash].prevElementHeight;var l=0,h=function(){$.setPageScroll(s.pageScroll);var e=$.getPageScroll();l++,(10>l&&e.x!==s.pageScroll.x||e.y!==s.pageScroll.y)&&$.requestAnimationFrame(h)};$.requestAnimationFrame(h),THIS[this.hash].fullPage=!1,$.delegate(this,onContainerExit)({})}return this.raiseEvent("full-page",{fullPage:e}),this},setFullScreen:function(e){var t=this;if(!$.supportsFullScreen)return this.setFullPage(e);if($.isFullScreen()===e)return this;var i={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",i),i.preventDefaultAction)return this;if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var n=function(){var e=$.isFullScreen();e||($.removeEvent(document,$.fullScreenEventName,n),$.removeEvent(document,$.fullScreenErrorEventName,n),t.setFullPage(!1),t.isFullPage()&&(t.element.style.width=t.fullPageStyleWidth,t.element.style.height=t.fullPageStyleHeight)),t.raiseEvent("full-screen",{fullScreen:e})};$.addEvent(document,$.fullScreenEventName,n),$.addEvent(document,$.fullScreenErrorEventName,n),$.requestFullScreen(document.body)}else $.cancelFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},bindSequenceControls:function(){var e=$.delegate(this,onFocus),t=$.delegate(this,onBlur),i=$.delegate(this,onNext),n=$.delegate(this,onPrevious),o=this.navImages,r=!0;return this.showSequenceControl&&THIS[this.hash].sequenced&&((this.previousButton||this.nextButton)&&(r=!1),this.previousButton=new $.Button({element:this.previousButton?$.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.PreviousPage"),srcRest:resolveUrl(this.prefixUrl,o.previous.REST),srcGroup:resolveUrl(this.prefixUrl,o.previous.GROUP),srcHover:resolveUrl(this.prefixUrl,o.previous.HOVER),srcDown:resolveUrl(this.prefixUrl,o.previous.DOWN),onRelease:n,onFocus:e,onBlur:t}),this.nextButton=new $.Button({element:this.nextButton?$.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.NextPage"),srcRest:resolveUrl(this.prefixUrl,o.next.REST),srcGroup:resolveUrl(this.prefixUrl,o.next.GROUP),srcHover:resolveUrl(this.prefixUrl,o.next.HOVER),srcDown:resolveUrl(this.prefixUrl,o.next.DOWN),onRelease:i,onFocus:e,onBlur:t}),this.navPrevNextWrap||this.previousButton.disable(),r&&(this.paging=new $.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:$.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:$.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var e=$.delegate(this,beginZoomingIn),t=$.delegate(this,endZooming),i=$.delegate(this,doSingleZoomIn),n=$.delegate(this,beginZoomingOut),o=$.delegate(this,doSingleZoomOut),r=$.delegate(this,onHome),s=$.delegate(this,onFullScreen),a=$.delegate(this,onFocus),l=$.delegate(this,onBlur),h=this.navImages,u=[],c=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton)&&(c=!1),u.push(this.zoomInButton=new $.Button({element:this.zoomInButton?$.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.ZoomIn"),srcRest:resolveUrl(this.prefixUrl,h.zoomIn.REST),srcGroup:resolveUrl(this.prefixUrl,h.zoomIn.GROUP),srcHover:resolveUrl(this.prefixUrl,h.zoomIn.HOVER),srcDown:resolveUrl(this.prefixUrl,h.zoomIn.DOWN),onPress:e,onRelease:t,onClick:i,onEnter:e,onExit:t,onFocus:a,onBlur:l})),u.push(this.zoomOutButton=new $.Button({element:this.zoomOutButton?$.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.ZoomOut"),srcRest:resolveUrl(this.prefixUrl,h.zoomOut.REST),srcGroup:resolveUrl(this.prefixUrl,h.zoomOut.GROUP),srcHover:resolveUrl(this.prefixUrl,h.zoomOut.HOVER),srcDown:resolveUrl(this.prefixUrl,h.zoomOut.DOWN),onPress:n,onRelease:t,onClick:o,onEnter:n,onExit:t,onFocus:a,onBlur:l})),u.push(this.homeButton=new $.Button({element:this.homeButton?$.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.Home"),srcRest:resolveUrl(this.prefixUrl,h.home.REST),srcGroup:resolveUrl(this.prefixUrl,h.home.GROUP),srcHover:resolveUrl(this.prefixUrl,h.home.HOVER),srcDown:resolveUrl(this.prefixUrl,h.home.DOWN),onRelease:r,onFocus:a,onBlur:l})),u.push(this.fullPageButton=new $.Button({element:this.fullPageButton?$.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:$.getString("Tooltips.FullPage"),srcRest:resolveUrl(this.prefixUrl,h.fullpage.REST),srcGroup:resolveUrl(this.prefixUrl,h.fullpage.GROUP),srcHover:resolveUrl(this.prefixUrl,h.fullpage.HOVER),srcDown:resolveUrl(this.prefixUrl,h.fullpage.DOWN),onRelease:s,onFocus:a,onBlur:l})),c&&(this.buttons=new $.ButtonGroup({buttons:u,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",$.delegate(this,lightUp)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:$.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:$.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return THIS[this.hash].sequence},goToPage:function(e){return e>=0&&e<this.tileSources.length&&(this.raiseEvent("page",{page:e}),THIS[this.hash].sequence=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e)),this},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources.length-1===e?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(e>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var t=$.makeNeutralElement("div");t.appendChild(document.createTextNode(e)),this.messageDiv=$.makeCenteredNode(t),$.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)}})}(OpenSeadragon),function(e){function t(t){var i,n,o;this.drag?this.drag=!1:this.viewer.viewport&&(n=this.viewport.deltaPointsFromPixels(t.position),o=this.viewer.viewport.getBounds().getSize(),i=new e.Rect(n.x-o.x/2,n.y-o.y/2,o.x,o.y),this.viewer.source.aspectRatio>this.viewer.viewport.getAspectRatio()?i.y=i.y-(this.viewerSizeInPoints.y-1/this.viewer.source.aspectRatio)/2:i.x=i.x-(this.viewerSizeInPoints.x-1)/2,this.viewer.viewport.fitBounds(i),this.viewer.viewport.applyConstraints())}function i(e){this.viewer.viewport&&(this.drag=!0,this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)))}function n(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}e.Navigator=function(o){var r,s=o.viewer,a=e.getElementSize(s.element);o.id?(this.element=document.getElementById(o.id),o.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(o.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),o.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:!0},o.position&&("BOTTOM_RIGHT"==o.position?o.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==o.position?o.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==o.position?o.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==o.position&&(o.controlOptions.anchor=e.ControlAnchor.TOP_LEFT))),this.element.id=o.id,this.element.className+=" navigator",o=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},o,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),o.minPixelRatio=this.minPixelRatio=s.minPixelRatio,this.viewerSizeInPoints=s.viewport.deltaPointsFromPixels(a),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),function(e,t){e.margin="0px",e.border=t+"px solid #555",e.padding="0px",e.background="#000",e.opacity=.8,e.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(e,t){e.position="relative",e.top="0px",e.left="0px",e.fontSize="0px",e.overflow="hidden",e.border=t+"px solid #900",e.margin="0px",e.padding="0px",e.background="transparent",e["float"]="left",e.cssFloat="left",e.styleFloat="left",e.zIndex=999999999,e.cursor="default"}(this.displayRegion.style,this.borderWidth),this.element.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,i),clickHandler:e.delegate(this,t),releaseHandler:e.delegate(this,n),scrollHandler:function(){return!1}}).setTracking(!0),s.addControl(this.element,o.controlOptions),o.width&&o.height?(this.element.style.width=o.width+"px",this.element.style.height=o.height+"px"):(this.element.style.width=a.x*o.sizeRatio+"px",this.element.style.height=a.y*o.sizeRatio+"px"),e.Viewer.apply(this,[o]),this.element.getElementsByTagName("form")[0].appendChild(this.displayRegion),r=this.element.getElementsByTagName("textarea")[0],r&&r.parentNode.removeChild(r)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{update:function(e){var t,i,n;e&&this.viewport&&(t=e.getBounds(!0),i=this.viewport.pixelFromPoint(t.getTopLeft()),n=this.viewport.pixelFromPoint(t.getBottomRight()).minus(this.totalBorderWidths),function(e){e.top=i.y+"px",e.left=i.x+"px";var t=Math.abs(i.x-n.x),o=Math.abs(i.y-n.y);e.width=Math.max(t,0)+"px",e.height=Math.max(o,0)+"px"}(this.displayRegion.style))},open:function(t){var i=this.viewer.viewport.containerSize.times(this.sizeRatio);return this.minPixelRatio=t.tileSize>i.x||t.tileSize>i.y?Math.min(i.x,i.y)/t.tileSize:this.viewer.minPixelRatio,e.Viewer.prototype.open.apply(this,[t])}})}(OpenSeadragon),function(e){var t={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page"}};e.extend(e,{getString:function(i){var n,o=i.split("."),r=null,s=arguments,a=t;for(n=0;n<o.length-1;n++)a=a[o[n]]||{};return r=a[o[n]],"string"!=typeof r&&(e.console.debug("Untranslated source string:",i),r=""),r.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<s.length?s[t]:""})},setString:function(e,i){var n,o=e.split("."),r=t;for(n=0;n<o.length-1;n++)r[o[n]]||(r[o[n]]={}),r=r[o[n]];r[o[n]]=i}})}(OpenSeadragon),function(e){e.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},e.Point.prototype={plus:function(t){return new e.Point(this.x+t.x,this.y+t.y)},minus:function(t){return new e.Point(this.x-t.x,this.y-t.y)},times:function(t){return new e.Point(this.x*t,this.y*t)},divide:function(t){return new e.Point(this.x/t,this.y/t)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},apply:function(t){return new e.Point(t(this.x),t(this.y))},equals:function(t){return t instanceof e.Point&&this.x===t.x&&this.y===t.y},rotate:function(t,i){var n=t*Math.PI/180,o=Math.cos(n)*(this.x-i.x)-Math.sin(n)*(this.y-i.y)+i.x,r=Math.sin(n)*(this.x-i.x)+Math.cos(n)*(this.y-i.y)+i.y;return new e.Point(o,r)},toString:function(){return"("+Math.round(this.x)+","+Math.round(this.y)+")"}}}(OpenSeadragon),function($){function processResponse(xhr){var responseText=xhr.responseText,status=xhr.status,statusText,data;if(!xhr)throw new Error($.getString("Errors.Security"));if(200!==xhr.status&&0!==xhr.status)throw status=xhr.status,statusText=404==status?"Not Found":xhr.statusText,new Error($.getString("Errors.Status",status,statusText));if(responseText.match(/\s*<.*/))try{data=xhr.responseXML&&xhr.responseXML.documentElement?xhr.responseXML:$.parseXml(responseText)}catch(e){data=xhr.responseText}else data=responseText.match(/\s*[\{\[].*/)?eval("("+responseText+")"):responseText;return data}$.TileSource=function(e){var t,i,n=null,o=arguments;for(t=$.isPlainObject(e)?e:{width:o[0],height:o[1],tileSize:o[2],tileOverlap:o[3],minLevel:o[4],maxLevel:o[5]},$.EventSource.call(this),$.extend(!0,this,t),i=0;i<arguments.length;i++)if($.isFunction(arguments[i])){n=arguments[i],this.addHandler("ready",function(e){n(e)});break}"string"==$.type(arguments[0])?(this.aspectRatio=1,this.dimensions=new $.Point(10,10),this.tileSize=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(arguments[0])):(this.ready=!0,this.aspectRatio=t.width&&t.height?t.width/t.height:1,this.dimensions=new $.Point(t.width,t.height),this.tileSize=t.tileSize?t.tileSize:0,this.tileOverlap=t.tileOverlap?t.tileOverlap:0,this.minLevel=t.minLevel?t.minLevel:0,this.maxLevel=void 0!==t.maxLevel&&null!==t.maxLevel?t.maxLevel:t.width&&t.height?Math.ceil(Math.log(Math.max(t.width,t.height))/Math.log(2)):0,n&&$.isFunction(n)&&n(this))},$.TileSource.prototype={getLevelScale:function(e){var t,i={};for(t=0;t<=this.maxLevel;t++)i[t]=1/Math.pow(2,this.maxLevel-t);return this.getLevelScale=function(e){return i[e]},this.getLevelScale(e)},getNumTiles:function(e){var t=this.getLevelScale(e),i=Math.ceil(t*this.dimensions.x/this.tileSize),n=Math.ceil(t*this.dimensions.y/this.tileSize);return new $.Point(i,n)},getPixelRatio:function(e){var t=this.dimensions.times(this.getLevelScale(e)),i=1/t.x,n=1/t.y;return new $.Point(i,n)},getClosestLevel:function(e){var t,i,n=Math.floor(Math.max(e.x,e.y)/this.tileSize);for(t=this.minLevel;t<this.maxLevel&&(i=this.getNumTiles(t),!(Math.max(i.x,i.y)+1>=n));t++);return Math.max(0,t-1)},getTileAtPoint:function(e,t){var i=t.times(this.dimensions.x).times(this.getLevelScale(e)),n=Math.floor(i.x/this.tileSize),o=Math.floor(i.y/this.tileSize);return new $.Point(n,o)},getTileBounds:function(e,t,i){var n=this.dimensions.times(this.getLevelScale(e)),o=0===t?0:this.tileSize*t-this.tileOverlap,r=0===i?0:this.tileSize*i-this.tileOverlap,s=this.tileSize+(0===t?1:2)*this.tileOverlap,a=this.tileSize+(0===i?1:2)*this.tileOverlap,l=1/n.x;return s=Math.min(s,n.x-o),a=Math.min(a,n.y-r),new $.Rect(o*l,r*l,s*l,a*l)},getImageInfo:function(e){var t,i,n,o,r,s,a,l=this;e&&(r=e.split("/"),s=r[r.length-1],a=s.lastIndexOf("."),a>-1&&(r[r.length-1]=s.slice(0,a))),i=function(t){"string"==typeof t&&(t=$.parseXml(t));var i=$.TileSource.determineType(l,t,e);return i?(o=i.prototype.configure.apply(l,[t,e]),n=new i(o),l.ready=!0,void l.raiseEvent("ready",{tileSource:n})):void l.raiseEvent("open-failed",{message:"Unable to load TileSource",source:e})},e.match(/\.js$/)?(t=e.split("/").pop().replace(".js",""),$.jsonp({url:e,async:!1,callbackName:t,callback:i})):$.makeAjaxRequest(e,function(e){var t=processResponse(e);i(t)},function(t,i){var n;try{n="HTTP "+t.status+" attempting to load TileSource"}catch(o){var r;r="undefined"!=typeof i&&i.toString?i.toString():"Unknown error",n=r+" attempting to load TileSource"}l.raiseEvent("open-failed",{message:n,source:e})})},supports:function(){return!1},configure:function(){throw new Error("Method not implemented.")},getTileUrl:function(){throw new Error("Method not implemented.")},tileExists:function(e,t,i){var n=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&t>=0&&i>=0&&t<n.x&&i<n.y}},$.extend(!0,$.TileSource.prototype,$.EventSource.prototype),$.TileSource.determineType=function(e,t,i){var n;for(n in OpenSeadragon)if(n.match(/.+TileSource$/)&&$.isFunction(OpenSeadragon[n])&&$.isFunction(OpenSeadragon[n].prototype.supports)&&OpenSeadragon[n].prototype.supports.call(e,t,i))return OpenSeadragon[n];$.console.error("No TileSource was able to open %s %s",i,t)}}(OpenSeadragon),function(e){function t(t,n){if(!n||!n.documentElement)throw new Error(e.getString("Errors.Xml"));var o,r,s,a,l,h=n.documentElement,u=h.tagName,c=null,d=[];if("Image"==u)try{if(a=h.getElementsByTagName("Size")[0],c={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:h.getAttribute("Url"),Format:h.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(h.getAttribute("Overlap"),10),TileSize:parseInt(h.getAttribute("TileSize"),10),Size:{Height:parseInt(a.getAttribute("Height"),10),Width:parseInt(a.getAttribute("Width"),10)}}},!e.imageFormatSupported(c.Image.Format))throw new Error(e.getString("Errors.ImageFormat",c.Image.Format.toUpperCase()));for(o=h.getElementsByTagName("DisplayRect"),l=0;l<o.length;l++)r=o[l],s=r.getElementsByTagName("Rect")[0],d.push({Rect:{X:parseInt(s.getAttribute("X"),10),Y:parseInt(s.getAttribute("Y"),10),Width:parseInt(s.getAttribute("Width"),10),Height:parseInt(s.getAttribute("Height"),10),MinLevel:parseInt(r.getAttribute("MinLevel"),10),MaxLevel:parseInt(r.getAttribute("MaxLevel"),10)}});return d.length&&(c.Image.DisplayRect=d),i(t,c)}catch(p){throw p instanceof Error?p:new Error(e.getString("Errors.Dzi"))}else{if("Collection"==u)throw new Error(e.getString("Errors.Dzc"));if("Error"==u)return e._processDZIError(h)}throw new Error(e.getString("Errors.Dzi"))}function i(t,i){var n,o,r=i.Image,s=r.Url,a=r.Format,l=r.Size,h=r.DisplayRect||[],u=parseInt(l.Width,10),c=parseInt(l.Height,10),d=parseInt(r.TileSize,10),p=parseInt(r.Overlap,10),m=[];for(o=0;o<h.length;o++)n=h[o].Rect,m.push(new e.DisplayRect(parseInt(n.X,10),parseInt(n.Y,10),parseInt(n.Width,10),parseInt(n.Height,10),parseInt(n.MinLevel,10),parseInt(n.MaxLevel,10)));return e.extend(!0,{width:u,height:c,tileSize:d,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:s,fileFormat:a,displayRects:m},i)}e.DziTileSource=function(t){var i,n,o,r;if(r=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=r.tilesUrl,this.fileFormat=r.fileFormat,this.displayRects=r.displayRects,this.displayRects)for(i=this.displayRects.length-1;i>=0;i--)for(n=this.displayRects[i],o=n.minLevel;o<=n.maxLevel;o++)this._levelRects[o]||(this._levelRects[o]=[]),this._levelRects[o].push(n);e.TileSource.apply(this,[r])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(e){var t;return e.Image?t=e.Image.xmlns:e.documentElement&&"Image"==e.documentElement.tagName&&(t=e.documentElement.namespaceURI),"http://schemas.microsoft.com/deepzoom/2008"==t||"http://schemas.microsoft.com/deepzoom/2009"==t},configure:function(n,o){var r;return r=e.isPlainObject(n)?i(this,n):t(this,n),o&&!r.tilesUrl&&(r.tilesUrl=o.replace(/([^\/]+)\.(dzi|xml|js)$/,"$1_files/")),r},getTileUrl:function(e,t,i){return[this.tilesUrl,e,"/",t,"_",i,".",this.fileFormat].join("")},tileExists:function(e,t,i){var n,o,r,s,a,l,h,u=this._levelRects[e];if(!u||!u.length)return!0;for(h=u.length-1;h>=0;h--)if(n=u[h],!(e<n.minLevel||e>n.maxLevel)&&(o=this.getLevelScale(e),r=n.x*o,s=n.y*o,a=r+n.width*o,l=s+n.height*o,r=Math.floor(r/this.tileSize),s=Math.floor(s/this.tileSize),a=Math.ceil(a/this.tileSize),l=Math.ceil(l/this.tileSize),t>=r&&a>t&&i>=s&&l>i))return!0;return!1}})}(OpenSeadragon),function(e){function t(t,o){if(!o||!o.documentElement)throw new Error(e.getString("Errors.Xml"));var r=o.documentElement,s=r.tagName,a=null;if("info"==s)try{return a={ns:r.namespaceURI},i(r,a),n(t,a)}catch(l){throw l instanceof Error?l:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function i(t,n,o){var r,s;if(3==t.nodeType&&o)s=t.nodeValue.trim(),s.match(/^\d*$/)&&(s=Number(s)),n[o]?(e.isArray(n[o])||(n[o]=[n[o]]),n[o].push(s)):n[o]=s;else if(1==t.nodeType)for(r=0;r<t.childNodes.length;r++)i(t.childNodes[r],n,t.nodeName)}function n(e,t){return t.image_host&&(t.tilesUrl=t.image_host),t}e.IIIFTileSource=function(t){if(e.extend(!0,this,t),!(this.height&&this.width&&this.identifier&&this.tilesUrl))throw new Error("IIIF required parameters not provided.");if(t.tileSize=this.tile_width,!t.maxLevel){var i=-1,n=this.scale_factors||this.scale_factor;if(n instanceof Array)for(var o=0;o<n.length;o++){var r=Number(n[o]);!isNaN(r)&&r>i&&(i=r)}t.maxLevel=0>i?Number(Math.ceil(Math.log(Math.max(this.width,this.height),2))):i}e.TileSource.apply(this,[t])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.ns&&"http://library.stanford.edu/iiif/image-api/ns/"==e.ns||e.profile&&("http://library.stanford.edu/iiif/image-api/compliance.html#level1"==e.profile||"http://library.stanford.edu/iiif/image-api/compliance.html#level2"==e.profile||"http://library.stanford.edu/iiif/image-api/compliance.html#level3"==e.profile||"http://library.stanford.edu/iiif/image-api/compliance.html"==e.profile)||e.documentElement&&"info"==e.documentElement.tagName&&"http://library.stanford.edu/iiif/image-api/ns/"==e.documentElement.namespaceURI},configure:function(i,o){var r,s,a;return s=e.isPlainObject(i)?n(this,i):t(this,i),o&&!s.tilesUrl&&(r=o.split("/"),r.pop(),r=r.join("/"),"http"!==o.substring(0,4)&&(a=location.protocol+"//"+location.host,r=a+r),s.tilesUrl=r.replace(i.identifier,"")),s},getTileUrl:function(e,t,i){var n,o,r,s,a,l,h="0",u="native.jpg",c=Math.pow(.5,this.maxLevel-e),d=Math.ceil(this.width*c),p=Math.ceil(this.height*c),m=Math.ceil(this.tileSize/c),f=Math.ceil(this.tileSize/c);return d<this.tile_width&&p<this.tile_height?(l=d+",",n="full"):(o=t*m,r=i*f,s=Math.min(m,this.width-o),a=Math.min(f,this.height-r),l=Math.ceil(s*c)+",",n=[o,r,s,a].join(",")),[this.tilesUrl,this.identifier,n,l,h,u].join("/")}})}(OpenSeadragon),function(e){e.IIIF1_1TileSource=function(t){if(e.extend(!0,this,t),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(t.tileSize=this.tile_width&&this.tile_height?this.tile_width:Math.min(this.height,this.width),!t.maxLevel){var i=-1,n=this.scale_factors||this.scale_factor;if(n instanceof Array)for(var o=0;o<n.length;o++){var r=Number(n[o]);!isNaN(r)&&r>i&&(i=r)}t.maxLevel=0>i?Number(Math.ceil(Math.log(Math.max(this.width,this.height),2))):i
}e.TileSource.apply(this,[t])},e.extend(e.IIIF1_1TileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.profile&&("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"==e.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"==e.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"==e.profile||"http://library.stanford.edu/iiif/image-api/1.1/compliance.html"==e.profile)},configure:function(e){return e},getTileUrl:function(e,t,i){var n,o,r,s,a,l,h,u="0",c="native.jpg",d=Math.pow(.5,this.maxLevel-e),p=Math.ceil(this.width*d),m=Math.ceil(this.height*d),f=Math.ceil(this.tileSize/d),g=Math.ceil(this.tileSize/d);return p<this.tile_width&&m<this.tile_height?(l=p+","+m,n="full"):(o=t*f,r=i*g,s=Math.min(f,this.width-o),a=Math.min(g,this.height-r),l=Math.ceil(s*d)+","+Math.ceil(a*d),n=[o,r,s,a].join(",")),h=[this["@id"],n,l,u,c].join("/")}})}(OpenSeadragon),function(e){e.OsmTileSource=function(t){var i;i=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},i.width&&i.height||(i.width=65572864,i.height=65572864),i.tileSize||(i.tileSize=256,i.tileOverlap=0),i.tilesUrl||(i.tilesUrl="http://tile.openstreetmap.org/"),i.minLevel=8,e.TileSource.apply(this,[i])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&"openstreetmaps"==e.type},configure:function(e){return e},getTileUrl:function(e,t,i){return this.tilesUrl+(e-8)+"/"+t+"/"+i+".png"}})}(OpenSeadragon),function(e){e.TmsTileSource=function(t){var i;i=e.isPlainObject(t)?t:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var n,o=256*Math.ceil(i.width/256),r=256*Math.ceil(i.height/256);n=o>r?o/256:r/256,i.maxLevel=Math.ceil(Math.log(n)/Math.log(2))-1,i.tileSize=256,i.width=o,i.height=r,e.TileSource.apply(this,[i])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&"tiledmapservice"==e.type},configure:function(e){return e},getTileUrl:function(e,t,i){var n=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(n-i)+".png"}})}(OpenSeadragon),function(e){function t(t){var i,n,o=[];for(n=0;n<t.length;n++)i=t[n],i.height&&i.width&&i.url&&(i.url.toLowerCase().match(/^.*\.(png|jpg|jpeg|gif)$/)||i.mimetype&&i.mimetype.toLowerCase().match(/^.*\/(png|jpg|jpeg|gif)$/))?o.push({url:i.url,width:Number(i.width),height:Number(i.height)}):e.console.error("Unsupported image format: %s",i.url?i.url:"<no URL>");return o.sort(function(e,t){return e.height-t.height})}function i(t,i){if(!i||!i.documentElement)throw new Error(e.getString("Errors.Xml"));var o,r,s=i.documentElement,a=s.tagName,l=null,h=[];if("image"==a)try{for(l={type:s.getAttribute("type"),levels:[]},h=s.getElementsByTagName("level"),r=0;r<h.length;r++)o=h[r],l.levels.push({url:o.getAttribute("url"),width:parseInt(o.getAttribute("width"),10),height:parseInt(o.getAttribute("height"),10)});return n(t,l)}catch(u){throw u instanceof Error?u:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==a)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==a)throw new Error("Error: "+i)}throw new Error("Unknown element "+a)}function n(e,t){return t.levels}e.LegacyTileSource=function(i){var n,o,r;e.isArray(i)&&(n={type:"legacy-image-pyramid",levels:i}),n.levels=t(n.levels),n.levels.length>0?(o=n.levels[n.levels.length-1].width,r=n.levels[n.levels.length-1].height):(o=0,r=0,e.console.error("No supported image formats found")),e.extend(!0,n,{width:o,height:r,tileSize:Math.max(r,o),tileOverlap:0,minLevel:0,maxLevel:n.levels.length>0?n.levels.length-1:0}),e.TileSource.apply(this,[n]),this.levels=n.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(e){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(t){var o;return o=e.isPlainObject(t)?n(this,t):i(this,t)},getLevelScale:function(e){var t=0/0;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(t){var i=this.getLevelScale(t);return i?new e.Point(1,1):new e.Point(0,0)},getTileAtPoint:function(){return new e.Point(0,0)},getTileUrl:function(e){var t=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].url),t}})}(OpenSeadragon),function(e){e.TileSourceCollection=function(t){var i;i=e.isPlainObject(t)?t:{tileSize:arguments[0],tileSources:arguments[1],rows:arguments[2],layout:arguments[3]},i.layout||(i.layout="horizontal");var n=0,o=1,r=Math.ceil(i.tileSources.length/i.rows),s=r>=i.rows?r:i.rows;for("horizontal"==i.layout?(i.width=i.tileSize*r,i.height=i.tileSize*i.rows):(i.height=i.tileSize*r,i.width=i.tileSize*i.rows),i.tileOverlap=-i.tileMargin,i.tilesPerRow=r;o<i.tileSize*s;)o=2*o,n++;i.minLevel=n,e.TileSource.apply(this,[i])},e.extend(e.TileSourceCollection.prototype,e.TileSource.prototype,{getTileBounds:function(t,i,n){var o=this.dimensions.times(this.getLevelScale(t)),r=this.tileSize*i-this.tileOverlap,s=this.tileSize*n-this.tileOverlap,a=this.tileSize+1*this.tileOverlap,l=this.tileSize+1*this.tileOverlap,h=1/o.x;return a=Math.min(a,o.x-r),l=Math.min(l,o.y-s),new e.Rect(r*h,s*h,a*h,l*h)},configure:function(){},getTileUrl:function(){return null}})}(OpenSeadragon),function(e){function t(t){e.requestAnimationFrame(function(){i(t)})}function i(i){var n,o,r;i.shouldFade&&(n=e.now(),o=n-i.fadeBeginTime,r=1-o/i.fadeLength,r=Math.min(1,r),r=Math.max(0,r),i.imgGroup&&e.setElementOpacity(i.imgGroup,r,!0),r>0&&t(i))}function n(i){i.shouldFade=!0,i.fadeBeginTime=e.now()+i.fadeDelay,window.setTimeout(function(){t(i)},i.fadeDelay)}function o(t){t.shouldFade=!1,t.imgGroup&&e.setElementOpacity(t.imgGroup,1,!0)}function r(t,i){t.element.disabled||(i>=e.ButtonState.GROUP&&t.currentState==e.ButtonState.REST&&(o(t),t.currentState=e.ButtonState.GROUP),i>=e.ButtonState.HOVER&&t.currentState==e.ButtonState.GROUP&&(t.imgHover&&(t.imgHover.style.visibility=""),t.currentState=e.ButtonState.HOVER),i>=e.ButtonState.DOWN&&t.currentState==e.ButtonState.HOVER&&(t.imgDown&&(t.imgDown.style.visibility=""),t.currentState=e.ButtonState.DOWN))}function s(t,i){t.element.disabled||(i<=e.ButtonState.HOVER&&t.currentState==e.ButtonState.DOWN&&(t.imgDown&&(t.imgDown.style.visibility="hidden"),t.currentState=e.ButtonState.HOVER),i<=e.ButtonState.GROUP&&t.currentState==e.ButtonState.HOVER&&(t.imgHover&&(t.imgHover.style.visibility="hidden"),t.currentState=e.ButtonState.GROUP),i<=e.ButtonState.REST&&t.currentState==e.ButtonState.GROUP&&(n(t),t.currentState=e.ButtonState.REST))}e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(t){var i=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},t),this.element=t.element||e.makeNeutralElement("button"),t.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor==e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="")),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(t){t.insideElementPressed?(r(i,e.ButtonState.DOWN),i.raiseEvent("enter",{originalEvent:t.originalEvent})):t.buttonDownAny||r(i,e.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),i.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(t){s(i,e.ButtonState.GROUP),t.insideElementPressed&&i.raiseEvent("exit",{originalEvent:t.originalEvent})},blurHandler:function(e){this.exitHandler(e),i.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(t){r(i,e.ButtonState.DOWN),i.raiseEvent("press",{originalEvent:t.originalEvent})},releaseHandler:function(t){t.insideElementPressed&&t.insideElementReleased?(s(i,e.ButtonState.HOVER),i.raiseEvent("release",{originalEvent:t.originalEvent})):t.insideElementPressed?s(i,e.ButtonState.GROUP):r(i,e.ButtonState.HOVER)},clickHandler:function(e){e.quick&&i.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13===e.keyCode?(i.raiseEvent("click",{originalEvent:e.originalEvent}),i.raiseEvent("release",{originalEvent:e.originalEvent}),!1):!0}}).setTracking(!0),s(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){r(this,e.ButtonState.GROUP)},notifyGroupExit:function(){s(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(e){e.ButtonGroup=function(t){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},t);var i,n=this.buttons.concat([]),o=this;if(this.element=t.element||e.makeNeutralElement("fieldgroup"),!t.group)for(this.label=e.makeNeutralElement("label"),this.element.style.display="inline-block",this.element.appendChild(this.label),i=0;i<n.length;i++)this.element.appendChild(n[i].element);this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(){var e;for(e=0;e<o.buttons.length;e++)o.buttons[e].notifyGroupEnter()},exitHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<o.buttons.length;t++)o.buttons[t].notifyGroupExit()},releaseHandler:function(e){var t;if(!e.insideElementReleased)for(t=0;t<o.buttons.length;t++)o.buttons[t].notifyGroupExit()}}).setTracking(!0)},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(e){e.Rect=function(e,t,i,n){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.width="number"==typeof i?i:0,this.height="number"==typeof n?n:0},e.Rect.prototype={getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height)},getTopRight:function(){return new e.Point(this.x+this.width,this.y)},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height)},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2)},getSize:function(){return new e.Point(this.width,this.height)},equals:function(t){return t instanceof e.Rect&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},rotate:function(t,i){var n,o=this.width,r=this.height;if(t=(t+360)%360,t%90!==0)throw new Error("Currently only 0, 90, 180, and 270 degrees are supported.");if(0===t)return new e.Rect(this.x,this.y,this.width,this.height);switch(i=i||this.getCenter(),t){case 90:n=this.getBottomLeft(),o=this.height,r=this.width;break;case 180:n=this.getBottomRight();break;case 270:n=this.getTopRight(),o=this.height,r=this.width;break;default:n=this.getTopLeft()}return n=n.rotate(t,i),new e.Rect(n.x,n.y,o,r)},toString:function(){return"["+Math.round(100*this.x)+","+Math.round(100*this.y)+","+Math.round(100*this.width)+"x"+Math.round(100*this.height)+"]"}}}(OpenSeadragon),function(e){function t(t){var i=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),r=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=e.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-t.delta.x>0?i>-(r-a.x)&&(this.element.style.marginLeft=i+2*t.delta.x+"px",n(this,a.x,i+2*t.delta.x)):-t.delta.x<0&&0>i&&(this.element.style.marginLeft=i+2*t.delta.x+"px",n(this,a.x,i+2*t.delta.x)):-t.delta.y>0?o>-(s-a.y)&&(this.element.style.marginTop=o+2*t.delta.y+"px",n(this,a.y,o+2*t.delta.y)):-t.delta.y<0&&0>o&&(this.element.style.marginTop=o+2*t.delta.y+"px",n(this,a.y,o+2*t.delta.y))),!1}function i(t){var i=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),r=Number(this.element.style.width.replace("px","")),s=Number(this.element.style.height.replace("px","")),a=e.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?t.scroll>0?i>-(r-a.x)&&(this.element.style.marginLeft=i-60*t.scroll+"px",n(this,a.x,i-60*t.scroll)):t.scroll<0&&0>i&&(this.element.style.marginLeft=i-60*t.scroll+"px",n(this,a.x,i-60*t.scroll)):t.scroll<0?o>a.y-s&&(this.element.style.marginTop=o+60*t.scroll+"px",n(this,a.y,o+60*t.scroll)):t.scroll>0&&0>o&&(this.element.style.marginTop=o+60*t.scroll+"px",n(this,a.y,o+60*t.scroll))),!1}function n(t,i,n){var o,r,s,a,l,h,u;for(o="horizontal"==t.scroll?t.panelWidth:t.panelHeight,r=Math.ceil(i/o)+5,s=Math.ceil((Math.abs(n)+i)/o)+1,r=s-r,r=0>r?0:r,h=r;s>h&&h<t.panels.length;h++)u=t.panels[h],u.activePanel||(a=new e.Viewer({id:u.id,tileSources:[t.viewer.tileSources[h]],element:u,navigatorSizeRatio:t.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),a.displayRegion=e.makeNeutralElement("textarea"),a.displayRegion.id=u.id+"-displayregion",a.displayRegion.className="displayregion",l=a.displayRegion.style,l.position="relative",l.top="0px",l.left="0px",l.fontSize="0px",l.overflow="hidden",l.float="left",l.cssFloat="left",l.styleFloat="left",l.zIndex=999999999,l.cursor="default",l.width=t.panelWidth-4+"px",l.height=t.panelHeight-4+"px",a.displayRegion.innerTracker=new e.MouseTracker({element:a.displayRegion}),u.getElementsByTagName("form")[0].appendChild(a.displayRegion),u.activePanel=!0)}function o(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="0px":t.style.marginLeft="0px",!1}function r(t){var i=t.eventSource.element;return"horizontal"==this.scroll?i.style.marginBottom="-"+e.getElementSize(i).y/2+"px":i.style.marginLeft="-"+e.getElementSize(i).x/2+"px",!1}function s(e){switch(e.keyCode){case 61:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:case 38:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 40:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 97:case 37:return i.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:case 39:return i.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}var a={};e.ReferenceStrip=function(l){var h,u,c,d=this,p=l.viewer,m=e.getElementSize(p.element);for(l.id||(l.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=l.id,this.element.className="referencestrip"),l=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},l,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),e.extend(this,l),a[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,u=this.element.style,u.marginTop="0px",u.marginRight="0px",u.marginBottom="0px",u.marginLeft="0px",u.left="0px",u.bottom="0px",u.border="0px",u.background="#000",u.position="relative",e.setElementOpacity(this.element,.8),this.viewer=p,this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,t),scrollHandler:e.delegate(this,i),enterHandler:e.delegate(this,o),exitHandler:e.delegate(this,r),keyHandler:e.delegate(this,s)}).setTracking(!0),l.width&&l.height?(this.element.style.width=l.width+"px",this.element.style.height=l.height+"px",p.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):"horizontal"==l.scroll?(this.element.style.width=m.x*l.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.height=m.y*l.sizeRatio+"px",p.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=m.y*l.sizeRatio*p.tileSources.length+12*p.tileSources.length+"px",this.element.style.width=m.x*l.sizeRatio+"px",p.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=m.x*this.sizeRatio+8,this.panelHeight=m.y*this.sizeRatio+8,this.panels=[],c=0;c<p.tileSources.length;c++)h=e.makeNeutralElement("div"),h.id=this.element.id+"-"+c,h.style.width=d.panelWidth+"px",h.style.height=d.panelHeight+"px",h.style.display="inline",h.style.float="left",h.style.cssFloat="left",h.style.styleFloat="left",h.style.padding="2px",h.innerTracker=new e.MouseTracker({element:h,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(t){t.eventSource.dragging=e.now()},releaseHandler:function(t){var i=t.eventSource,n=i.element.id,o=Number(n.split("-")[2]),r=e.now();t.insideElementPressed&&t.insideElementReleased&&i.dragging&&r-i.dragging<i.clickTimeThreshold&&(i.dragging=null,p.goToPage(o))}}).setTracking(!0),this.element.appendChild(h),h.activePanel=!1,this.panels.push(h);n(this,"vertical"==this.scroll?m.y:m.y,0),this.setFocus(0)},e.extend(e.ReferenceStrip.prototype,e.EventSource.prototype,e.Viewer.prototype,{setFocus:function(t){var i,r=e.getElement(this.element.id+"-"+t),s=e.getElementSize(this.viewer.canvas),a=Number(this.element.style.width.replace("px","")),l=Number(this.element.style.height.replace("px","")),h=-Number(this.element.style.marginLeft.replace("px","")),u=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==r&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=r,this.currentSelected.style.background="#999","horizontal"==this.scroll?(i=Number(t)*(this.panelWidth+3),i>h+s.x-this.panelWidth?(i=Math.min(i,a-s.x),this.element.style.marginLeft=-i+"px",n(this,s.x,-i)):h>i&&(i=Math.max(0,i-s.x/2),this.element.style.marginLeft=-i+"px",n(this,s.x,-i))):(i=Number(t)*(this.panelHeight+3),i>u+s.y-this.panelHeight?(i=Math.min(i,l-s.y),this.element.style.marginTop=-i+"px",n(this,s.y,-i)):u>i&&(i=Math.max(0,i-s.y/2),this.element.style.marginTop=-i+"px",n(this,s.y,-i))),this.currentPage=t,e.getElement(r.id+"-displayregion").focus(),o.call(this,{eventSource:this.innerTracker}))},update:function(){return a[this.id].animating?(e.console.log("image reference strip update"),!0):!1}})}(OpenSeadragon),function(e){e.DisplayRect=function(t,i,n,o,r,s){e.Rect.apply(this,[t,i,n,o]),this.minLevel=r,this.maxLevel=s},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(OpenSeadragon),function(e){function t(e,t){return(1-Math.exp(e*-t))/(1-Math.exp(-e))}e.Spring=function(t){var i=arguments;"object"!=typeof t&&(t={initial:i.length&&"number"==typeof i[0]?i[0]:0,springStiffness:i.length>1?i[1].springStiffness:5,animationTime:i.length>1?i[1].animationTime:1.5}),e.extend(!0,this,t),this.current={value:"number"==typeof this.initial?this.initial:0,time:e.now()},this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time}},e.Spring.prototype={resetTo:function(e){this.target.value=e,this.target.time=this.current.time,this.start.value=this.target.value,this.start.time=this.target.time},springTo:function(e){this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime},shiftBy:function(e){this.start.value+=e,this.target.value+=e},update:function(){this.current.time=e.now(),this.current.value=this.current.time>=this.target.time?this.target.value:this.start.value+(this.target.value-this.start.value)*t(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time))}}}(OpenSeadragon),function(e){var t={};e.Tile=function(e,t,i,n,o,r){this.level=e,this.x=t,this.y=i,this.bounds=n,this.exists=o,this.url=r,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.distance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},drawHTML:function(t){return this.loaded&&this.image?(this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=e.makeNeutralElement("img"),this.imgElement.src=this.url,this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=t&&t.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",void e.setElementOpacity(this.element,this.opacity)):void e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())},drawCanvas:function(i){var n,o,r=this.position,s=this.size;return this.loaded&&(this.image||t[this.url])?(i.globalAlpha=this.opacity,1==i.globalAlpha&&this.url.match(".png")&&i.clearRect(r.x+1,r.y+1,s.x-2,s.y-2),t[this.url]||(o=document.createElement("canvas"),o.width=this.image.width,o.height=this.image.height,n=o.getContext("2d"),n.drawImage(this.image,0,0),t[this.url]=n,this.image=null),n=t[this.url],void i.drawImage(n.canvas,0,0,n.canvas.width,n.canvas.height,r.x,r.y,s.x,s.y)):void e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),t[this.url]&&delete t[this.url],this.element=null,this.imgElement=null,this.image=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(e){e.OverlayPlacement={CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8},e.Overlay=function(t,i,n){var o;o=e.isPlainObject(t)?t:{element:t,location:i,placement:n},this.element=o.element,this.scales=o.location instanceof e.Rect,this.bounds=new e.Rect(o.location.x,o.location.y,o.location.width,o.location.height),this.position=new e.Point(o.location.x,o.location.y),this.size=new e.Point(o.location.width,o.location.height),this.style=o.element.style,this.placement=o.location instanceof e.Point?o.placement:e.OverlayPlacement.TOP_LEFT,this.onDraw=o.onDraw},e.Overlay.prototype={adjust:function(t,i){switch(this.placement){case e.OverlayPlacement.TOP_LEFT:break;case e.OverlayPlacement.TOP:t.x-=i.x/2;break;case e.OverlayPlacement.TOP_RIGHT:t.x-=i.x;break;case e.OverlayPlacement.RIGHT:t.x-=i.x,t.y-=i.y/2;break;case e.OverlayPlacement.BOTTOM_RIGHT:t.x-=i.x,t.y-=i.y;break;case e.OverlayPlacement.BOTTOM:t.x-=i.x/2,t.y-=i.y;break;case e.OverlayPlacement.BOTTOM_LEFT:t.y-=i.y;break;case e.OverlayPlacement.LEFT:t.y-=i.y/2;break;default:case e.OverlayPlacement.CENTER:t.x-=i.x/2,t.y-=i.y/2}},destroy:function(){var e=this.element,t=this.style;e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent&&(t.display="none",document.body.appendChild(e))),this.onDraw=null,t.top="",t.left="",t.position="",this.scales&&(t.width="",t.height="")},drawHTML:function(t,i){var n,o,r,s=this.element,a=this.style,l=this.scales,h=new e.Point(i.viewer.drawer.canvas.width/2,i.viewer.drawer.canvas.height/2),u=i.degrees;s.parentNode!=t&&(s.prevElementParent=s.parentNode,s.prevNextSibling=s.nextSibling,t.appendChild(s)),l||(this.size=e.getElementSize(s)),n=this.position,o=this.size,this.adjust(n,o),n=n.apply(Math.floor),o=o.apply(Math.ceil),0!==u&&this.scales&&(r=new e.Point(o.x/2,o.y/2),n=n.plus(r).rotate(u,h).minus(r),o=o.rotate(u,new e.Point(0,0)),o=new e.Point(Math.abs(o.x),Math.abs(o.y))),this.onDraw?this.onDraw(n,o,s):(a.left=n.x+"px",a.top=n.y+"px",a.position="absolute",a.display="block",l&&(a.width=o.x+"px",a.height=o.y+"px"))},update:function(t,i){this.scales=t instanceof e.Rect,this.bounds=new e.Rect(t.x,t.y,t.width,t.height),this.placement=t instanceof e.Point?i:e.OverlayPlacement.TOP_LEFT}}}(OpenSeadragon),function(e){function t(t,i){var n=null,o=i.height&&i.width?new e.Rect(i.x||i.px,i.y||i.py,i.width,i.height):new e.Point(i.x||i.px,i.y||i.py),r=i.id?i.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());return n=e.getElement(i.id),n||(n=document.createElement("a"),n.href="#/overlay/"+r),n.id=r,e.addClass(n,i.className?i.className:"openseadragon-overlay"),void 0!==i.px&&(o=t.viewport.imageToViewportRectangle(o)),new e.Overlay(i.placement?{element:n,location:t.viewport.pointFromPixel(o),placement:e.OverlayPlacement[i.placement.toUpperCase()],onDraw:i.onDraw}:{element:n,location:o,onDraw:i.onDraw})}function i(t){t.updateAgain=!1,t.viewer&&t.viewer.raiseEvent("update-viewport",{});for(var i,o,r,a,l,h,u,d,p=null,m=!1,f=e.now(),g=t.viewport.getContainerSize(),v=t.viewport.getBounds(!0),y=v.getTopLeft(),b=v.getBottomRight(),x=t.viewport.deltaPixelsFromPoints(t.source.getPixelRatio(0),!0).x,T=Math.max(t.source.minLevel,Math.floor(Math.log(t.minZoomImageRatio)/Math.log(2))),E=Math.min(Math.abs(t.source.maxLevel),Math.abs(Math.floor(Math.log(x/t.minPixelRatio)/Math.log(2)))),C=t.viewport.degrees;t.lastDrawn.length>0;)i=t.lastDrawn.pop(),i.beingDrawn=!1;if(t.canvas.innerHTML="",t.useCanvas&&((t.canvas.width!=g.x||t.canvas.height!=g.y)&&(t.canvas.width=g.x,t.canvas.height=g.y),t.context.clearRect(0,0,g.x,g.y)),90===C||270===C){var _=v.rotate(C);y=_.getTopLeft(),b=_.getBottomRight()}if(!(!t.wrapHorizontal&&(b.x<0||y.x>1)||!t.wrapVertical&&(b.y<0||y.y>t.normHeight))){t.wrapHorizontal||(y.x=Math.max(y.x,0),b.x=Math.min(b.x,1)),t.wrapVertical||(y.y=Math.max(y.y,0),b.y=Math.min(b.y,t.normHeight)),T=Math.min(T,E);var P;for(o=E;o>=T;o--){if(P=!1,r=t.viewport.deltaPixelsFromPoints(t.source.getPixelRatio(o),!0).x,!m&&r>=t.minPixelRatio||o==T)P=!0,m=!0;else if(!m)continue;if(a=t.viewport.deltaPixelsFromPoints(t.source.getPixelRatio(o),!1).x,l=t.viewport.deltaPixelsFromPoints(t.source.getPixelRatio(Math.max(t.source.getClosestLevel(t.viewport.containerSize)-1,0)),!1).x,h=t.immediateRender?1:l,u=Math.min(1,(r-.5)/.5),d=h/Math.abs(h-a),p=n(t,m,P,o,u,d,y,b,f,p),c(t.coverage,o))break}S(t,t.lastDrawn),w(t.viewport,t.overlays,t.container),p&&(s(t,p,f),t.updateAgain=!0)}}function n(e,t,i,n,r,s,a,l,h,u){var c,d,p,f,g,v=e.viewport.pixelFromPoint(e.viewport.getCenter());for(e.viewer&&e.viewer.raiseEvent("update-level",{havedrawn:t,level:n,opacity:r,visibility:s,topleft:a,bottomright:l,currenttime:h,best:u}),p=e.source.getTileAtPoint(n,a),f=e.source.getTileAtPoint(n,l),g=e.source.getNumTiles(n),m(e.coverage,n),e.wrapHorizontal||(f.x=Math.min(f.x,g.x-1)),e.wrapVertical||(f.y=Math.min(f.y,g.y-1)),c=p.x;c<=f.x;c++)for(d=p.y;d<=f.y;d++)u=o(e,i,t,c,d,n,r,s,v,g,h,u);return u}function o(e,t,i,n,o,s,a,u,c,m,f,v){var w=r(n,o,s,e.source,e.tilesMatrix,f,m,e.normHeight),y=t;if(e.viewer&&e.viewer.raiseEvent("update-tile",{tile:w}),p(e.coverage,s,n,o,!1),!w.exists)return v;if(i&&!y&&(d(e.coverage,s,n,o)?p(e.coverage,s,n,o,!0):y=!0),!y)return v;if(l(w,e.source.tileOverlap,e.viewport,c,u),w.loaded){var S=h(e,w,n,o,s,a,f);S&&(e.updateAgain=!0)}else w.loading||(v=g(v,w));return v}function r(t,i,n,o,r,s,a,l){var h,u,c,d,p,m;return r[n]||(r[n]={}),r[n][t]||(r[n][t]={}),r[n][t][i]||(h=(a.x+t%a.x)%a.x,u=(a.y+i%a.y)%a.y,c=o.getTileBounds(n,h,u),d=o.tileExists(n,h,u),p=o.getTileUrl(n,h,u),c.x+=1*(t-h)/a.x,c.y+=l*(i-u)/a.y,r[n][t][i]=new e.Tile(n,t,i,c,d,p)),m=r[n][t][i],m.lastTouchTime=s,m}function s(e,t,i){e.viewport.collectionMode?(e.midUpdate=!1,a(e,t,i)):t.loading=e.loadImage(t.url,function(n){a(e,t,i,n)})}function a(t,i,n,o){var r,s,a,l,h,u,c,d,p,m;if(i.loading=!1,t.midUpdate)return void e.console.warn("Tile load callback in middle of drawing routine.");if(o||t.viewport.collectionMode){if(n<t.lastResetTime)return void e.console.log("Ignoring tile %s loaded before reset: %s",i,i.url)}else if(e.console.log("Tile %s failed to load: %s",i,i.url),!t.debugMode)return void(i.exists=!1);if(i.loaded=!0,i.image=o,r=t.tilesLoaded.length,t.tilesLoaded.length>=t.maxImageCacheCount){for(s=Math.ceil(Math.log(t.source.tileSize)/Math.log(2)),a=null,u=-1,m=t.tilesLoaded.length-1;m>=0;m--)c=t.tilesLoaded[m],c.level<=t.cutoff||c.beingDrawn||(a?(d=c.lastTouchTime,l=a.lastTouchTime,p=c.level,h=a.level,(l>d||d==l&&p>h)&&(a=c,u=m)):(a=c,u=m));a&&u>=0&&(a.unload(),r=u)}t.tilesLoaded[r]=i,t.updateAgain=!0}function l(t,i,n,o,r){var s=t.bounds.getTopLeft(),a=t.bounds.getSize(),l=n.pixelFromPoint(s,!0),h=n.pixelFromPoint(s,!1),u=n.deltaPixelsFromPoints(a,!0),c=n.deltaPixelsFromPoints(a,!1),d=h.plus(c.divide(2)),p=o.distanceTo(d);i||(u=u.plus(new e.Point(1,1))),t.position=l,t.size=u,t.distance=p,t.visibility=r}function h(e,t,i,n,o,r,s){var a,l,h=1e3*e.blendTime;if(t.blendStart||(t.blendStart=s),a=s-t.blendStart,l=h?Math.min(1,a/h):1,e.alwaysBlend&&(l*=r),t.opacity=l,e.lastDrawn.push(t),1==l)p(e.coverage,o,i,n,!0);else if(h>a)return!0;return!1}function u(e){e.tilesMatrix={},e.tilesLoaded=[]}function c(e,t,i,n){var o,r,s,a;if(!e[t])return!1;if(void 0===i||void 0===n){o=e[t];for(s in o)if(o.hasOwnProperty(s)){r=o[s];for(a in r)if(r.hasOwnProperty(a)&&!r[a])return!1}return!0}return void 0===e[t][i]||void 0===e[t][i][n]||e[t][i][n]===!0}function d(e,t,i,n){return void 0===i||void 0===n?c(e,t+1):c(e,t+1,2*i,2*n)&&c(e,t+1,2*i,2*n+1)&&c(e,t+1,2*i+1,2*n)&&c(e,t+1,2*i+1,2*n+1)}function p(t,i,n,o,r){return t[i]?(t[i][n]||(t[i][n]={}),void(t[i][n][o]=r)):void e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",i)}function m(e,t){e[t]={}}function f(e,t){var i;for(i=e.length-1;i>=0;i--)if(e[i].element==t)return i;return-1}function g(e,t){return e?t.visibility>e.visibility?t:t.visibility==e.visibility&&t.distance<e.distance?t:e:t}function v(t,i,n,o){t.onload=null,t.onabort=null,t.onerror=null,o&&window.clearTimeout(o),e.requestAnimationFrame(function(){i(t.src,n?t:null)})}function w(e,t,i){var n,o=t.length;for(n=0;o>n;n++)y(e,t[n],i)}function y(e,t,i){t.position=e.pixelFromPoint(t.bounds.getTopLeft(),!0),t.size=e.deltaPixelsFromPoints(t.bounds.getSize(),!0),t.drawHTML(i,e)
}function S(t,i){var n,o,r,s,a,l,h,u;for(n=i.length-1;n>=0;n--){if(o=i[n],t.viewport.collectionMode?(r=o.x+"/"+o.y,a=t.viewport,u=a.collectionTileSource,t.collectionOverlays[r]?(s=t.collectionOverlays[r],s.viewport&&(s.viewport.resize(o.size,!0),s.viewport.goHome(!0))):(l="horizontal"==u.layout?o.y+o.x*u.rows:o.x+o.y*u.rows,h=l<u.tileSources.length?u.tileSources[l]:null,h&&(t.collectionOverlays[r]=s=new e.Viewer({hash:a.viewer.hash+"-"+r,element:e.makeNeutralElement("div"),mouseNavEnabled:!1,showNavigator:!1,showSequenceControl:!1,showNavigationControl:!1,tileSources:[h]}),_&&(s.element.style.border="1px solid rgba(255,255,255,0.38)",s.element.style["-webkit-box-reflect"]="below 0px -webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(62%,transparent),to(rgba(255,255,255,0.62)))"),t.addOverlay(s.element,o.bounds)))):(t.useCanvas?0!==t.viewport.degrees?(b(o,t.canvas,t.context,t.viewport.degrees),o.drawCanvas(t.context),x(o,t.canvas,t.context)):o.drawCanvas(t.context):o.drawHTML(t.canvas),o.beingDrawn=!0),t.debugMode)try{T(t,o,i.length,n)}catch(c){e.console.error(c)}t.viewer&&t.viewer.raiseEvent("tile-drawn",{tile:o})}}function b(e,t,i,n){var o=t.width/2,r=t.height/2,s=e.position.x-o,a=e.position.y-r;i.save(),i.translate(o,r),i.rotate(Math.PI/180*n),e.position.x=s,e.position.y=a}function x(e,t,i){var n=t.width/2,o=t.height/2,r=e.position.x+n,s=e.position.y+o;e.position.x=r,e.position.y=s,i.restore()}function T(e,t,i,n){e.useCanvas&&(e.context.save(),e.context.lineWidth=2,e.context.font="small-caps bold 13px ariel",e.context.strokeStyle=e.debugGridColor,e.context.fillStyle=e.debugGridColor,e.context.strokeRect(t.position.x,t.position.y,t.size.x,t.size.y),0===t.x&&0===t.y&&(e.context.fillText("Zoom: "+e.viewport.getZoom(),t.position.x,t.position.y-30),e.context.fillText("Pan: "+e.viewport.getBounds().toString(),t.position.x,t.position.y-20)),e.context.fillText("Level: "+t.level,t.position.x+10,t.position.y+20),e.context.fillText("Column: "+t.x,t.position.x+10,t.position.y+30),e.context.fillText("Row: "+t.y,t.position.x+10,t.position.y+40),e.context.fillText("Order: "+n+" of "+i,t.position.x+10,t.position.y+50),e.context.fillText("Size: "+t.size.toString(),t.position.x+10,t.position.y+60),e.context.fillText("Position: "+t.position.toString(),t.position.x+10,t.position.y+70),e.context.restore())}var E=(e.getWindowSize(),e.Browser.vendor),C=e.Browser.version,_=E==e.BROWSERS.FIREFOX||E==e.BROWSERS.OPERA||E==e.BROWSERS.SAFARI&&C>=4||E==e.BROWSERS.CHROME&&C>=2||E==e.BROWSERS.IE&&C>=9;e.Drawer=function(i){var n,o=arguments;for(e.isPlainObject(i)||(i={source:o[0],viewport:o[1],element:o[2]}),e.extend(!0,this,{viewer:null,downloading:0,tilesMatrix:{},tilesLoaded:[],coverage:{},lastDrawn:[],lastResetTime:0,midUpdate:!1,updateAgain:!0,overlays:[],collectionOverlays:{},maxImageCacheCount:e.DEFAULT_SETTINGS.maxImageCacheCount,imageLoaderLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,debugMode:e.DEFAULT_SETTINGS.debugMode,timeout:e.DEFAULT_SETTINGS.timeout},i),this.useCanvas=e.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=e.getElement(this.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.normHeight=this.source.dimensions.y/this.source.dimensions.x,this.element=this.container,this.container.dir="ltr",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",this.container.style.textAlign="left",this.container.appendChild(this.canvas),n=0;n<this.overlays.length;n++)e.isPlainObject(this.overlays[n])?this.overlays[n]=t(this,this.overlays[n]):e.isFunction(this.overlays[n])},e.Drawer.prototype={addOverlay:function(t,i,n,o){var r;return r=e.isPlainObject(t)?t:{element:t,location:i,placement:n,onDraw:o},t=e.getElement(r.element),f(this.overlays,t)>=0?void 0:(this.overlays.push(new e.Overlay({element:t,location:r.location,placement:r.placement,onDraw:r.onDraw})),this.updateAgain=!0,this.viewer&&this.viewer.raiseEvent("add-overlay",{element:t,location:r.location,placement:r.placement}),this)},updateOverlay:function(t,i,n){var o;return t=e.getElement(t),o=f(this.overlays,t),o>=0&&(this.overlays[o].update(i,n),this.updateAgain=!0),this.viewer&&this.viewer.raiseEvent("update-overlay",{element:t,location:i,placement:n}),this},removeOverlay:function(t){var i;return t=e.getElement(t),i=f(this.overlays,t),i>=0&&(this.overlays[i].destroy(),this.overlays.splice(i,1),this.updateAgain=!0),this.viewer&&this.viewer.raiseEvent("remove-overlay",{element:t}),this},clearOverlays:function(){for(;this.overlays.length>0;)this.overlays.pop().destroy(),this.updateAgain=!0;return this.viewer&&this.viewer.raiseEvent("clear-overlay",{}),this},needsUpdate:function(){return this.updateAgain},numTilesLoaded:function(){return this.tilesLoaded.length},reset:function(){return u(this),this.lastResetTime=e.now(),this.updateAgain=!0,this},update:function(){return this.midUpdate=!0,i(this),this.midUpdate=!1,this},loadImage:function(t,i){var n,o,r,s=this,a=!1;return(!this.imageLoaderLimit||this.downloading<this.imageLoaderLimit)&&(this.downloading++,n=new Image,r=function(n,o){if(s.downloading--,"function"==typeof i)try{i(o)}catch(r){e.console.error("%s while executing %s callback: %s",r.name,t,r.message,r)}},n.onload=function(){v(n,r,!0,o)},n.onabort=n.onerror=function(){v(n,r,!1,o)},o=window.setTimeout(function(){v(n,r,!1,o)},this.timeout),a=!0,n.src=t),a},canRotate:function(){return this.useCanvas}}}(OpenSeadragon),function(e){e.Viewport=function(t){var i=arguments;i.length&&i[0]instanceof e.Point&&(t={containerSize:i[0],contentSize:i[1],config:i[2]}),t.config&&(e.extend(!0,t,t.config),delete t.config),e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees},t),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.resetContentSize(this.contentSize),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(t){return this.contentSize=t,this.contentAspectX=this.contentSize.x/this.contentSize.y,this.contentAspectY=this.contentSize.y/this.contentSize.x,this.fitWidthBounds=new e.Rect(0,0,1,this.contentAspectY),this.fitHeightBounds=new e.Rect(0,0,this.contentAspectY,this.contentAspectY),this.homeBounds=new e.Rect(0,0,1,this.contentAspectY),this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:t}),this},getHomeZoom:function(){var e=this.contentAspectX/this.getAspectRatio();return this.defaultZoomLevel?this.defaultZoomLevel:e>=1?1:e},getHomeBounds:function(){var t=this.homeBounds.getCenter(),i=1/this.getHomeZoom(),n=i/this.getAspectRatio();return new e.Rect(t.x-i/2,t.y-n/2,i,n)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom(),t=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e;return Math.min(t,e)},getMaxZoom:function(){var e=this.maxZoomLevel?this.maxZoomLevel:this.contentSize.x*this.maxZoomPixelRatio/this.containerSize.x;return Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this.containerSize.x/this.containerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getBounds:function(t){var i=this.getCenter(t),n=1/this.getZoom(t),o=n/this.getAspectRatio();return new e.Rect(i.x-n/2,i.y-o/2,n,o)},getCenter:function(t){var i,n,o,r,s,a,l,h,u=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),c=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return t?u:this.zoomPoint?(i=this.pixelFromPoint(this.zoomPoint,!0),n=this.getZoom(),o=1/n,r=o/this.getAspectRatio(),s=new e.Rect(u.x-o/2,u.y-r/2,o,r),a=this.zoomPoint.minus(s.getTopLeft()).times(this.containerSize.x/s.width),l=a.minus(i),h=l.divide(this.containerSize.x*n),c.plus(h)):c},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},applyConstraints:function(e){var t,i,n,o,r,s,a,l=this.getZoom(),h=Math.max(Math.min(l,this.getMaxZoom()),this.getMinZoom()),u=0,c=0;return l!=h&&this.zoomTo(h,this.zoomPoint,e),t=this.getBounds(),i=this.visibilityRatio*t.width,n=this.visibilityRatio*t.height,o=t.x+t.width,r=1-t.x,s=t.y+t.height,a=this.contentAspectY-t.y,this.wrapHorizontal||(i>o&&(u=i-o),i>r&&(u=u?(u+r-i)/2:r-i)),this.wrapVertical||(n>s&&(c=n-s),n>a&&(c=c?(c+a-n)/2:a-n)),(u||c||e)&&(t.x+=u,t.y+=c,t.width>1&&(t.x=.5-t.width/2),t.height>this.contentAspectY&&(t.y=this.contentAspectY/2-t.height/2),this.fitBounds(t,e)),this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e}),this},ensureVisible:function(e){return this.applyConstraints(e)},fitBounds:function(t,i){var n,o,r,s,a=this.getAspectRatio(),l=t.getCenter(),h=new e.Rect(t.x,t.y,t.width,t.height);return h.getAspectRatio()>=a?(h.height=t.width/a,h.y=l.y-h.height/2):(h.width=t.height*a,h.x=l.x-h.width/2),this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0),n=this.getBounds(),o=this.getZoom(),r=1/h.width,r==o||h.width==n.width?this.panTo(l,i):(s=n.getTopLeft().times(this.containerSize.x/n.width).minus(h.getTopLeft().times(this.containerSize.x/h.width)).divide(this.containerSize.x/n.width-this.containerSize.x/h.width),this.zoomTo(r,s,i))},fitVertically:function(e){var t=this.getCenter();return this.wrapHorizontal&&(t.x=(1+t.x%1)%1,this.centerSpringX.resetTo(t.x),this.centerSpringX.update()),this.wrapVertical&&(t.y=(this.contentAspectY+t.y%this.contentAspectY)%this.contentAspectY,this.centerSpringY.resetTo(t.y),this.centerSpringY.update()),this.fitBounds(this.fitHeightBounds,e)},fitHorizontally:function(e){var t=this.getCenter();return this.wrapHorizontal&&(t.x=(this.contentAspectX+t.x%this.contentAspectX)%this.contentAspectX,this.centerSpringX.resetTo(t.x),this.centerSpringX.update()),this.wrapVertical&&(t.y=(1+t.y%1)%1,this.centerSpringY.resetTo(t.y),this.centerSpringY.update()),this.fitBounds(this.fitWidthBounds,e)},panBy:function(t,i){var n=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return t=t.rotate(-this.degrees,new e.Point(0,0)),this.panTo(n.plus(t),i)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(t,i,n){return i instanceof e.Point&&!isNaN(i.x)&&!isNaN(i.y)&&(i=i.rotate(-this.degrees,new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value))),this.zoomTo(this.zoomSpring.target.value*t,i,n)},zoomTo:function(t,i,n){return this.zoomPoint=i instanceof e.Point&&!isNaN(i.x)&&!isNaN(i.y)?i:null,n?this.zoomSpring.resetTo(t):this.zoomSpring.springTo(t),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:t,refPoint:i,immediately:n}),this},setRotation:function(e){if(!this.viewer||!this.viewer.drawer.canRotate())return this;if(e=(e+360)%360,e%90!==0)throw new Error("Currently only 0, 90, 180, and 270 degrees are supported.");return this.degrees=e,this.viewer.drawer.update(),this},getRotation:function(){return this.degrees},resize:function(t,i){var n,o=this.getBounds(),r=o;return this.containerSize=new e.Point(t.x,t.y),i&&(n=t.x/this.containerSize.x,r.width=o.width*n,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:t,maintain:i}),this.fitBounds(r,!0)},update:function(){var e,t,i,n,o=this.centerSpringX.current.value,r=this.centerSpringY.current.value,s=this.zoomSpring.current.value;return this.zoomPoint&&(e=this.pixelFromPoint(this.zoomPoint,!0)),this.zoomSpring.update(),this.zoomPoint&&this.zoomSpring.current.value!=s?(t=this.pixelFromPoint(this.zoomPoint,!0),i=t.minus(e),n=this.deltaPointsFromPixels(i,!0),this.centerSpringX.shiftBy(n.x),this.centerSpringY.shiftBy(n.y)):this.zoomPoint=null,this.centerSpringX.update(),this.centerSpringY.update(),this.centerSpringX.current.value!=o||this.centerSpringY.current.value!=r||this.zoomSpring.current.value!=s},deltaPixelsFromPoints:function(e,t){return e.times(this.containerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return e.divide(this.containerSize.x*this.getZoom(t))},pixelFromPoint:function(e,t){var i=this.getBounds(t);return e.minus(i.getTopLeft()).times(this.containerSize.x/i.width)},pointFromPixel:function(e,t){var i=this.getBounds(t);return e.divide(this.containerSize.x/i.width).plus(i.getTopLeft())},viewportToImageCoordinates:function(t,i){return 1==arguments.length?this.viewportToImageCoordinates(t.x,t.y):new e.Point(t*this.contentSize.x,i*this.contentSize.y*this.contentAspectX)},imageToViewportCoordinates:function(t,i){return 1==arguments.length?this.imageToViewportCoordinates(t.x,t.y):new e.Point(t/this.contentSize.x,i/this.contentSize.y/this.contentAspectX)},imageToViewportRectangle:function(t,i,n,o){var r,s,a;return 1==arguments.length?(a=t,this.imageToViewportRectangle(a.x,a.y,a.width,a.height)):(r=this.imageToViewportCoordinates(t,i),s=this.imageToViewportCoordinates(n,o),new e.Rect(r.x,r.y,s.x,s.y))},viewportToImageRectangle:function(t,i,n,o){var r,s,a;return 1==arguments.length?(a=t,this.viewportToImageRectangle(a.x,a.y,a.width,a.height)):(r=this.viewportToImageCoordinates(t,i),s=this.viewportToImageCoordinates(n,o),new e.Rect(r.x,r.y,s.x,s.y))},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.pixelFromPoint(e,!0);return this.imageToViewportCoordinates(t)},windowToImageCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){var t=this.imageToViewerElementCoordinates(e);return t.plus(OpenSeadragon.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},windowToViewportCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(t)},viewportToWindowCoordinates:function(e){var t=this.viewportToViewerElementCoordinates(e);return t.plus(OpenSeadragon.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){var t=this.viewer.source.dimensions.x,i=this.getContainerSize().x,n=i/t;return e*n},imageToViewportZoom:function(e){var t=this.viewer.source.dimensions.x,i=this.getContainerSize().x,n=t/i;return e*n}}}(OpenSeadragon),function(e){var t={interval:5e3,fade_class:"fade_out",fadeables:[],timeout:null,cancel:!1},i={init:function(n){return n&&e.extend(t,n),t.$_this=this,t.fadeables=e(t.fadeables),t.fadeables.addClass("fadeable"),i.fadeOut(),e(document).bind("click.spotlight",i.fadeIn).bind("keyup.spotlight",i.fadeIn).bind("mousemove.spotlight",i.fadeIn),e(t.fadeables).bind("mouseover.spotlight",i.mouseoverOthers).bind("mouseout.spotlight",i.mouseoutOthers),this},mouseoverOthers:function(){t.cancel=!0,window.clearTimeout(t.timeout)},mouseoutOthers:function(){t.cancel=!1,window.clearTimeout(t.timeout),t.timeout=window.setTimeout(i.fadeOut,t.interval)},fadeIn:function(){e(t.fadeables).removeClass(t.fade_class),window.clearTimeout(t.timeout),t.timeout=window.setTimeout(i.fadeOut,t.interval)},fadeOut:function(){t.cancel||e(t.fadeables).addClass("fade_out"),window.clearTimeout(t.timeout)},destroy:function(){i.fadeIn(),e(t.fadeables).unbind(".spotlight"),e(document).unbind(".spotlight"),window.clearTimeout(t.timeout)},option:function(e,i){return i?void(t[e]=i):t[e]}};e.fn.spotlight=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.spotlight"):i.init.apply(this,arguments)}}(jQuery),function(e,t){function i(t,i){var o,r,s,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,r=o.name,t.href&&r&&"map"===o.nodeName.toLowerCase()?(s=e("img[usemap=#"+r+"]")[0],!!s&&n(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var n,o,r=e(this[0]);r.length&&r[0]!==document;){if(n=r.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),o=isNaN(n);return(o||n>=0)&&i(t,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(i,n){function o(t,i,n,o){return e.each(r,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var r="Width"===n?["Left","Right"]:["Top","Bottom"],s=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(i){return i===t?a["inner"+n].call(this):this.each(function(){e(this).css(s,o(this,i)+"px")})},e.fn["outer"+n]=function(t,i){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(s,o(this,t,!0,i)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,n){var o,r=e.ui[t].prototype;for(o in n)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([i,n[o]])},call:function(e,t,i){var n,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;o.length>n;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return t[n]>0?!0:(t[n]=1,o=t[n]>0,t[n]=0,o)}})}(jQuery),function(e,t){var i=0,n=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(r){}o(t)},e.widget=function(i,n,o){var r,s,a,l,h={},u=i.split(".")[0];i=i.split(".")[1],r=u+"-"+i,o||(o=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[u]=e[u]||{},s=e[u][i],a=e[u][i]=function(e,i){return this._createWidget?(arguments.length&&this._createWidget(e,i),t):new a(e,i)},e.extend(a,s,{version:o.version,_proto:e.extend({},o),_childConstructors:[]}),l=new n,l.options=e.widget.extend({},l.options),e.each(o,function(i,o){return e.isFunction(o)?(h[i]=function(){var e=function(){return n.prototype[i].apply(this,arguments)},t=function(e){return n.prototype[i].apply(this,e)};return function(){var i,n=this._super,r=this._superApply;return this._super=e,this._superApply=t,i=o.apply(this,arguments),this._super=n,this._superApply=r,i}}(),t):(h[i]=o,t)}),a.prototype=e.widget.extend(l,{widgetEventPrefix:s?l.widgetEventPrefix||i:i},h,{constructor:a,namespace:u,widgetName:i,widgetFullName:r}),s?(e.each(s._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete s._childConstructors):n._childConstructors.push(a),e.widget.bridge(i,a)},e.widget.extend=function(i){for(var o,r,s=n.call(arguments,1),a=0,l=s.length;l>a;a++)for(o in s[a])r=s[a][o],s[a].hasOwnProperty(o)&&r!==t&&(i[o]=e.isPlainObject(r)?e.isPlainObject(i[o])?e.widget.extend({},i[o],r):e.widget.extend({},r):r);return i},e.widget.bridge=function(i,o){var r=o.prototype.widgetFullName||i;e.fn[i]=function(s){var a="string"==typeof s,l=n.call(arguments,1),h=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,this.each(a?function(){var n,o=e.data(this,r);return o?e.isFunction(o[s])&&"_"!==s.charAt(0)?(n=o[s].apply(o,l),n!==o&&n!==t?(h=n&&n.jquery?h.pushStack(n.get()):n,!1):t):e.error("no such method '"+s+"' for "+i+" widget instance"):e.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,r);t?t.option(s||{})._init():e.data(this,r,new o(s,this))}),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(i,n){var o,r,s,a=i;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof i)if(a={},o=i.split("."),i=o.shift(),o.length){for(r=a[i]=e.widget.extend({},this.options[i]),s=0;o.length-1>s;s++)r[o[s]]=r[o[s]]||{},r=r[o[s]];if(i=o.pop(),1===arguments.length)return r[i]===t?null:r[i];r[i]=n}else{if(1===arguments.length)return this.options[i]===t?null:this.options[i];a[i]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(i,n,o){var r,s=this;"boolean"!=typeof i&&(o=n,n=i,i=!1),o?(n=r=e(n),this.bindings=this.bindings.add(n)):(o=n,n=this.element,r=this.widget()),e.each(o,function(o,a){function l(){return i||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?s[a]:a).apply(s,arguments):t}"string"!=typeof a&&(l.guid=a.guid=a.guid||l.guid||e.guid++);var h=o.match(/^(\w+)\s*(.*)$/),u=h[1]+s.eventNamespace,c=h[2];c?r.delegate(c,u,l):n.bind(u,l)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,r,s=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],r=i.originalEvent)for(o in r)o in i||(i[o]=r[o]);return this.element.trigger(i,n),!(e.isFunction(s)&&s.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,r){"string"==typeof o&&(o={effect:o});var s,a=o?o===!0||"number"==typeof o?i:o.effect||i:t;o=o||{},"number"==typeof o&&(o={duration:o}),s=!e.isEmptyObject(o),o.complete=r,o.delay&&n.delay(o.delay),s&&e.effects&&e.effects.effect[a]?n[t](o):a!==t&&n[a]?n[a](o.duration,o.easing,r):n.queue(function(i){e(this)[t](),r&&r.call(n[0]),i()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,o=1===i.which,r="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return o&&!r&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){var t=5;e.widget("ui.slider",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,n=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),r="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",s=[];for(i=n.values&&n.values.length||1,o.length>i&&(o.slice(i).remove(),o=o.slice(0,i)),t=o.length;i>t;t++)s.push(r);this.handles=o.add(e(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)
},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,n,o,r,s,a,l,h,u=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(i),o=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(n-u.values(t));(o>i||o===i&&(t===u._lastChangedValue||u.values(t)===c.min))&&(o=i,r=e(this),s=t)}),a=this._start(t,s),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=s,r.addClass("ui-state-active").focus(),l=r.offset(),h=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=h?{left:0,top:0}:{left:t.pageX-l.left-r.width()/2,top:t.pageY-l.top-r.height()/2-(parseInt(r.css("borderTopWidth"),10)||0)-(parseInt(r.css("borderBottomWidth"),10)||0)+(parseInt(r.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,s,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,o,r;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),n=i/t,n>1&&(n=1),0>n&&(n=0),"vertical"===this.orientation&&(n=1-n),o=this._valueMax()-this._valueMin(),r=this._valueMin()+n*o,this._trimAlignValue(r)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var n,o,r;this.options.values&&this.options.values.length?(n=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>n||1===t&&n>i)&&(i=n),i!==this.values(t)&&(o=this.values(),o[t]=i,r=this._trigger("slide",e,{handle:this.handles[t],value:i,values:o}),n=this.values(t?0:1),r!==!1&&this.values(t,i))):i!==this.value()&&(r=this._trigger("slide",e,{handle:this.handles[t],value:i}),r!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,i){var n,o,r;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(n=this.options.values,o=arguments[0],r=0;n.length>r;r+=1)n[r]=this._trimAlignValue(o[r]),this._change(null,r);this._refreshValue()},_setOption:function(t,i){var n,o=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(o=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;o>n;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;i.length>n;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,i,n,o,r,s=this.options.range,a=this.options,l=this,h=this._animateOff?!1:a.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(n){i=100*((l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())),u["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[h?"animate":"css"](u,a.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:a.animate}))),t=i}):(n=this.value(),o=this._valueMin(),r=this._valueMax(),i=r!==o?100*((n-o)/(r-o)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](u,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(i){var n,o,r,s,a=e(i.target).data("ui-slider-handle-index");switch(i.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(i.target).addClass("ui-state-active"),n=this._start(i,a),n===!1))return}switch(s=this.options.step,o=r=this.options.values&&this.options.values.length?this.values(a):this.value(),i.keyCode){case e.ui.keyCode.HOME:r=this._valueMin();break;case e.ui.keyCode.END:r=this._valueMax();break;case e.ui.keyCode.PAGE_UP:r=this._trimAlignValue(o+(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(o-(this._valueMax()-this._valueMin())/t);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(o===this._valueMax())return;r=this._trimAlignValue(o+s);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(o===this._valueMin())return;r=this._trimAlignValue(o-s)}this._slide(i,a,r)},click:function(e){e.preventDefault()},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){"use strict";var t={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},i=function(){var e=0;return function(){var t=e;return e+=1,".perfect-scrollbar-"+t}}();e.fn.perfectScrollbar=function(n,o){return this.each(function(){var r=e.extend(!0,{},t),s=e(this);if("object"==typeof n?e.extend(!0,r,n):o=n,"update"===o)return s.data("perfect-scrollbar-update")&&s.data("perfect-scrollbar-update")(),s;if("destroy"===o)return s.data("perfect-scrollbar-destroy")&&s.data("perfect-scrollbar-destroy")(),s;if(s.data("perfect-scrollbar"))return s.data("perfect-scrollbar");s.addClass("ps-container");var a,l,h,u,c,d,p,m,f,g,v=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(s),w=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(s),y=e("<div class='ps-scrollbar-x'></div>").appendTo(v),S=e("<div class='ps-scrollbar-y'></div>").appendTo(w),b=parseInt(v.css("bottom"),10),x=b===b,T=x?null:parseInt(v.css("top"),10),E=parseInt(w.css("right"),10),C=E===E,_=C?null:parseInt(w.css("left"),10),P="rtl"===s.css("direction"),O=i(),M=function(e,t){var i=e+t,n=u-f;g=0>i?0:i>n?n:i;var o=parseInt(g*(d-u)/(u-f),10);s.scrollTop(o),v.css(x?{bottom:b-o}:{top:T+o})},k=function(e,t){var i=e+t,n=h-p;m=0>i?0:i>n?n:i;var o=parseInt(m*(c-h)/(h-p),10);s.scrollLeft(o),w.css(C?{right:E-o}:{left:_+o})},I=function(e){return r.minScrollbarLength&&(e=Math.max(e,r.minScrollbarLength)),e},R=function(){var e={width:h,display:a?"inherit":"none"};e.left=P?s.scrollLeft()+h-c:s.scrollLeft(),x?e.bottom=b-s.scrollTop():e.top=T+s.scrollTop(),v.css(e);var t={top:s.scrollTop(),height:u,display:l?"inherit":"none"};C?t.right=P?c-s.scrollLeft()-E-S.outerWidth():E-s.scrollLeft():t.left=P?s.scrollLeft()+2*h-c-_-S.outerWidth():_+s.scrollLeft(),w.css(t),y.css({left:m,width:p}),S.css({top:g,height:f})},D=function(){h=r.includePadding?s.innerWidth():s.width(),u=r.includePadding?s.innerHeight():s.height(),c=s.prop("scrollWidth"),d=s.prop("scrollHeight"),!r.suppressScrollX&&c>h+r.scrollXMarginOffset?(a=!0,p=I(parseInt(h*h/c,10)),m=parseInt(s.scrollLeft()*(h-p)/(c-h),10)):(a=!1,p=0,m=0,s.scrollLeft(0)),!r.suppressScrollY&&d>u+r.scrollYMarginOffset?(l=!0,f=I(parseInt(u*u/d,10)),g=parseInt(s.scrollTop()*(u-f)/(d-u),10)):(l=!1,f=0,g=0,s.scrollTop(0)),g>=u-f&&(g=u-f),m>=h-p&&(m=h-p),R()},z=function(){var t,i;y.bind("mousedown"+O,function(e){i=e.pageX,t=y.position().left,v.addClass("in-scrolling"),e.stopPropagation(),e.preventDefault()}),e(document).bind("mousemove"+O,function(e){v.hasClass("in-scrolling")&&(k(t,e.pageX-i),e.stopPropagation(),e.preventDefault())}),e(document).bind("mouseup"+O,function(){v.hasClass("in-scrolling")&&v.removeClass("in-scrolling")}),t=i=null},B=function(){var t,i;S.bind("mousedown"+O,function(e){i=e.pageY,t=S.position().top,w.addClass("in-scrolling"),e.stopPropagation(),e.preventDefault()}),e(document).bind("mousemove"+O,function(e){w.hasClass("in-scrolling")&&(M(t,e.pageY-i),e.stopPropagation(),e.preventDefault())}),e(document).bind("mouseup"+O,function(){w.hasClass("in-scrolling")&&w.removeClass("in-scrolling")}),t=i=null},H=function(e,t){var i=s.scrollTop();if(0===e){if(!l)return!1;if(0===i&&t>0||i>=d-u&&0>t)return!r.wheelPropagation}var n=s.scrollLeft();if(0===t){if(!a)return!1;if(0===n&&0>e||n>=c-h&&e>0)return!r.wheelPropagation}return!0},A=function(){r.wheelSpeed/=10;var e=!1;s.bind("mousewheel"+O,function(t,i,n,o){var h=t.deltaX*t.deltaFactor||n,u=t.deltaY*t.deltaFactor||o;e=!1,r.useBothWheelAxes?l&&!a?(s.scrollTop(u?s.scrollTop()-u*r.wheelSpeed:s.scrollTop()+h*r.wheelSpeed),e=!0):a&&!l&&(s.scrollLeft(h?s.scrollLeft()+h*r.wheelSpeed:s.scrollLeft()-u*r.wheelSpeed),e=!0):(s.scrollTop(s.scrollTop()-u*r.wheelSpeed),s.scrollLeft(s.scrollLeft()+h*r.wheelSpeed)),D(),e=e||H(h,u),e&&(t.stopPropagation(),t.preventDefault())}),s.bind("MozMousePixelScroll"+O,function(t){e&&t.preventDefault()})},L=function(){var t=!1;s.bind("mouseenter"+O,function(){t=!0}),s.bind("mouseleave"+O,function(){t=!1});var i=!1;e(document).bind("keydown"+O,function(n){if(t&&!e(document.activeElement).is(":input,[contenteditable]")){var o=0,r=0;switch(n.which){case 37:o=-30;break;case 38:r=30;break;case 39:o=30;break;case 40:r=-30;break;case 33:r=90;break;case 32:case 34:r=-90;break;case 35:r=-u;break;case 36:r=u;break;default:return}s.scrollTop(s.scrollTop()-r),s.scrollLeft(s.scrollLeft()+o),i=H(o,r),i&&n.preventDefault()}})},N=function(){var e=function(e){e.stopPropagation()};S.bind("click"+O,e),w.bind("click"+O,function(e){var t=parseInt(f/2,10),i=e.pageY-w.offset().top-t,n=u-f,o=i/n;0>o?o=0:o>1&&(o=1),s.scrollTop((d-u)*o)}),y.bind("click"+O,e),v.bind("click"+O,function(e){var t=parseInt(p/2,10),i=e.pageX-v.offset().left-t,n=h-p,o=i/n;0>o?o=0:o>1&&(o=1),s.scrollLeft((c-h)*o)})},F=function(){var t=function(e,t){s.scrollTop(s.scrollTop()-t),s.scrollLeft(s.scrollLeft()-e),D()},i={},n=0,o={},r=null,a=!1;e(window).bind("touchstart"+O,function(){a=!0}),e(window).bind("touchend"+O,function(){a=!1}),s.bind("touchstart"+O,function(e){var t=e.originalEvent.targetTouches[0];i.pageX=t.pageX,i.pageY=t.pageY,n=(new Date).getTime(),null!==r&&clearInterval(r),e.stopPropagation()}),s.bind("touchmove"+O,function(e){if(!a&&1===e.originalEvent.targetTouches.length){var r=e.originalEvent.targetTouches[0],s={};s.pageX=r.pageX,s.pageY=r.pageY;var l=s.pageX-i.pageX,h=s.pageY-i.pageY;t(l,h),i=s;var u=(new Date).getTime(),c=u-n;c>0&&(o.x=l/c,o.y=h/c,n=u),e.preventDefault()}}),s.bind("touchend"+O,function(){clearInterval(r),r=setInterval(function(){return.01>Math.abs(o.x)&&.01>Math.abs(o.y)?void clearInterval(r):(t(30*o.x,30*o.y),o.x*=.8,void(o.y*=.8))},10)})},$=function(){s.bind("scroll"+O,function(){D()})},U=function(){s.unbind(O),e(window).unbind(O),e(document).unbind(O),s.data("perfect-scrollbar",null),s.data("perfect-scrollbar-update",null),s.data("perfect-scrollbar-destroy",null),y.remove(),S.remove(),v.remove(),w.remove(),v=w=y=S=a=l=h=u=c=d=p=m=b=x=T=f=g=E=C=_=P=O=null},W=function(t){s.addClass("ie").addClass("ie"+t);var i=function(){var t=function(){e(this).addClass("hover")},i=function(){e(this).removeClass("hover")};s.bind("mouseenter"+O,t).bind("mouseleave"+O,i),v.bind("mouseenter"+O,t).bind("mouseleave"+O,i),w.bind("mouseenter"+O,t).bind("mouseleave"+O,i),y.bind("mouseenter"+O,t).bind("mouseleave"+O,i),S.bind("mouseenter"+O,t).bind("mouseleave"+O,i)},n=function(){R=function(){var e={left:m+s.scrollLeft(),width:p};x?e.bottom=b:e.top=T,y.css(e);var t={top:g+s.scrollTop(),height:f};C?t.right=E:t.left=_,S.css(t),y.hide().show(),S.hide().show()}};6===t&&(i(),n())},q="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,j=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);e&&"msie"===e[1]&&W(parseInt(e[2],10)),D(),$(),z(),B(),N(),q&&F(),s.mousewheel&&A(),r.useKeyboard&&L(),s.data("perfect-scrollbar",s),s.data("perfect-scrollbar-update",D),s.data("perfect-scrollbar-destroy",U)};return j(),s})}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),h=0,u=0,c=0,d=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(c=-1*s.detail),"wheelDelta"in s&&(c=s.wheelDelta),"wheelDeltaY"in s&&(c=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*c,c=0),h=0===c?u:c,"deltaY"in s&&(c=-1*s.deltaY,h=c),"deltaX"in s&&(u=s.deltaX,0===c&&(h=-1*u)),0!==c||0!==u){if(1===s.deltaMode){var p=e.data(this,"mousewheel-line-height");h*=p,c*=p,u*=p}else if(2===s.deltaMode){var m=e.data(this,"mousewheel-page-height");h*=m,c*=m,u*=m}return d=Math.max(Math.abs(c),Math.abs(u)),(!r||r>d)&&(r=d,n(s,d)&&(r/=40)),n(s,d)&&(h/=40,u/=40,c/=40),h=Math[h>=1?"floor":"ceil"](h/r),u=Math[u>=1?"floor":"ceil"](u/r),c=Math[c>=1?"floor":"ceil"](c/r),t.deltaX=u,t.deltaY=c,t.deltaFactor=r,t.deltaMode=0,a.unshift(t,h,u,c),o&&clearTimeout(o),o=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){r=null}function n(e,t){return u.settings.adjustOldDeltas&&"mousewheel"===e.type&&0===t%120}var o,r,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var h=s.length;h;)e.event.fixHooks[s[--h]]=e.event.mouseHooks;var u=e.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",u.getLineHeight(this)),e.data(this,"mousewheel-page-height",u.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=a.length;e;)this.removeEventListener(a[--e],t,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(e(t)["offsetParent"in e.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e){var t={init:function(t){var i={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},t=e.extend(!0,i,t);return this.each(function(){var i=e(this);if(t.set_width&&i.css("width",t.set_width),t.set_height&&i.css("height",t.set_height),e(document).data("mCustomScrollbar-index")){var n=parseInt(e(document).data("mCustomScrollbar-index"));e(document).data("mCustomScrollbar-index",n+1)}else e(document).data("mCustomScrollbar-index","1");i.wrapInner("<div class='mCustomScrollBox mCS-"+t.theme+"' id='mCSB_"+e(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+e(document).data("mCustomScrollbar-index"));var o=i.children(".mCustomScrollBox");if(t.horizontalScroll){o.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var r=o.children(".mCSB_h_wrapper");r.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:r.children().outerWidth(),position:"relative"}).unwrap()}else o.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var s=o.children(".mCSB_container");e.support.touch&&s.addClass("mCS_touch"),s.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var a=o.children(".mCSB_scrollTools"),l=a.children(".mCSB_draggerContainer"),h=l.children(".mCSB_dragger");if(t.horizontalScroll?h.data("minDraggerWidth",h.width()):h.data("minDraggerHeight",h.height()),t.scrollButtons.enable&&(t.horizontalScroll?a.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):a.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),o.bind("scroll",function(){i.is(".mCS_disabled")||o.scrollTop(0).scrollLeft(0)}),i.data({mCS_Init:!0,mCustomScrollbarIndex:e(document).data("mCustomScrollbar-index"),horizontalScroll:t.horizontalScroll,scrollInertia:t.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:t.mouseWheel,mouseWheelPixels:t.mouseWheelPixels,autoDraggerLength:t.autoDraggerLength,autoHideScrollbar:t.autoHideScrollbar,scrollButtons_enable:t.scrollButtons.enable,scrollButtons_scrollType:t.scrollButtons.scrollType,scrollButtons_scrollSpeed:t.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:t.scrollButtons.scrollAmount,autoExpandHorizontalScroll:t.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:t.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:t.advanced.normalizeMouseWheelDelta,contentTouchScroll:t.contentTouchScroll,onScrollStart_Callback:t.callbacks.onScrollStart,onScroll_Callback:t.callbacks.onScroll,onTotalScroll_Callback:t.callbacks.onTotalScroll,onTotalScrollBack_Callback:t.callbacks.onTotalScrollBack,onTotalScroll_Offset:t.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:t.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:t.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),t.horizontalScroll)"none"!==i.css("max-width")&&(t.advanced.updateOnContentResize||(t.advanced.updateOnContentResize=!0));else if("none"!==i.css("max-height")){var u=!1,c=parseInt(i.css("max-height"));i.css("max-height").indexOf("%")>=0&&(u=c,c=i.parent().height()*u/100),i.css("overflow","hidden"),o.css("max-height",c)}if(i.mCustomScrollbar("update"),t.advanced.updateOnBrowserResize){var d,p=e(window).width(),m=e(window).height();e(window).bind("resize."+i.data("mCustomScrollbarIndex"),function(){d&&clearTimeout(d),d=setTimeout(function(){if(!i.is(".mCS_disabled")&&!i.is(".mCS_destroyed")){var t=e(window).width(),n=e(window).height();(p!==t||m!==n)&&("none"!==i.css("max-height")&&u&&o.css("max-height",i.parent().height()*u/100),i.mCustomScrollbar("update"),p=t,m=n)}},150)})}if(t.advanced.updateOnContentResize){var f;if(t.horizontalScroll)var g=s.outerWidth();else var g=s.outerHeight();f=setInterval(function(){if(t.horizontalScroll){t.advanced.autoExpandHorizontalScroll&&s.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:s.outerWidth(),position:"relative"}).unwrap();var e=s.outerWidth()}else var e=s.outerHeight();e!=g&&(i.mCustomScrollbar("update"),g=e)},300)}})},update:function(){var t=e(this),i=t.children(".mCustomScrollBox"),n=i.children(".mCSB_container");n.removeClass("mCS_no_scrollbar"),t.removeClass("mCS_disabled mCS_destroyed"),i.scrollTop(0).scrollLeft(0);var o=i.children(".mCSB_scrollTools"),r=o.children(".mCSB_draggerContainer"),s=r.children(".mCSB_dragger");if(t.data("horizontalScroll")){var a=o.children(".mCSB_buttonLeft"),l=o.children(".mCSB_buttonRight"),h=i.width();t.data("autoExpandHorizontalScroll")&&n.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:n.outerWidth(),position:"relative"}).unwrap();var u=n.outerWidth()}else var c=o.children(".mCSB_buttonUp"),d=o.children(".mCSB_buttonDown"),p=i.height(),m=n.outerHeight();if(m>p&&!t.data("horizontalScroll")){o.css("display","block");var f=r.height();if(t.data("autoDraggerLength")){var g=Math.round(p/m*f),v=s.data("minDraggerHeight");if(v>=g)s.css({height:v});else if(g>=f-10){var w=f-10;s.css({height:w})}else s.css({height:g});s.children(".mCSB_dragger_bar").css({"line-height":s.height()+"px"})}var y=s.height(),S=(m-p)/(f-y);t.data("scrollAmount",S).mCustomScrollbar("scrolling",i,n,r,s,c,d,a,l);var b=Math.abs(n.position().top);t.mCustomScrollbar("scrollTo",b,{scrollInertia:0})}else if(u>h&&t.data("horizontalScroll")){o.css("display","block");var x=r.width();if(t.data("autoDraggerLength")){var T=Math.round(h/u*x),E=s.data("minDraggerWidth");if(E>=T)s.css({width:E});else if(T>=x-10){var C=x-10;s.css({width:C})}else s.css({width:T})}var _=s.width(),S=(u-h)/(x-_);t.data("scrollAmount",S).mCustomScrollbar("scrolling",i,n,r,s,c,d,a,l);var b=Math.abs(n.position().left);t.mCustomScrollbar("scrollTo",b,{scrollInertia:0})}else i.unbind("mousewheel focusin"),t.data("horizontalScroll")?s.add(n).css("left",0):s.add(n).css("top",0),o.css("display","none"),n.addClass("mCS_no_scrollbar"),t.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(t,n,o,r,s,a,l,h){function u(e,t,i,n){p.data("horizontalScroll")?p.mCustomScrollbar("scrollTo",r.position().left-t+n,{moveDragger:!0,trigger:"internal"}):p.mCustomScrollbar("scrollTo",r.position().top-e+i,{moveDragger:!0,trigger:"internal"})}function c(e){r.data("preventAction")||(r.data("preventAction",!0),p.mCustomScrollbar("scrollTo",e,{trigger:"internal"}))}function d(){var e=p.data("scrollButtons_scrollSpeed");return"auto"===p.data("scrollButtons_scrollSpeed")&&(e=Math.round((p.data("scrollInertia")+100)/40)),e}var p=e(this);if(!p.data("bindEvent_scrollbar_drag")){var m,f;e.support.msPointer?(r.bind("MSPointerDown",function(t){t.preventDefault(),p.data({on_drag:!0}),r.addClass("mCSB_dragger_onDrag");var i=e(this),n=i.offset(),o=t.originalEvent.pageX-n.left,s=t.originalEvent.pageY-n.top;o<i.width()&&o>0&&s<i.height()&&s>0&&(m=s,f=o)}),e(document).bind("MSPointerMove."+p.data("mCustomScrollbarIndex"),function(e){if(e.preventDefault(),p.data("on_drag")){var t=r,i=t.offset(),n=e.originalEvent.pageX-i.left,o=e.originalEvent.pageY-i.top;u(m,f,o,n)}}).bind("MSPointerUp."+p.data("mCustomScrollbarIndex"),function(e){e.preventDefault(),p.data({on_drag:!1}),r.removeClass("mCSB_dragger_onDrag")})):(r.bind("mousedown touchstart",function(t){t.preventDefault(),t.stopImmediatePropagation();var i,n,o=e(this),s=o.offset();if("touchstart"===t.type){var a=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];i=a.pageX-s.left,n=a.pageY-s.top}else p.data({on_drag:!0}),r.addClass("mCSB_dragger_onDrag"),i=t.pageX-s.left,n=t.pageY-s.top;i<o.width()&&i>0&&n<o.height()&&n>0&&(m=n,f=i)}).bind("touchmove",function(t){t.preventDefault(),t.stopImmediatePropagation();var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],n=e(this),o=n.offset(),r=i.pageX-o.left,s=i.pageY-o.top;u(m,f,s,r)}),e(document).bind("mousemove."+p.data("mCustomScrollbarIndex"),function(e){if(e.preventDefault(),p.data("on_drag")){var t=r,i=t.offset(),n=e.pageX-i.left,o=e.pageY-i.top;u(m,f,o,n)}}).bind("mouseup."+p.data("mCustomScrollbarIndex"),function(e){e.preventDefault(),p.data({on_drag:!1}),r.removeClass("mCSB_dragger_onDrag")})),p.data({bindEvent_scrollbar_drag:!0})}if(e.support.touch&&p.data("contentTouchScroll")&&!p.data("bindEvent_content_touch")){var g,v,w,y,S,b,x;n.bind("touchstart",function(t){t.stopImmediatePropagation(),g=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],v=e(this),w=v.offset(),S=g.pageX-w.left,y=g.pageY-w.top,b=y,x=S}),n.bind("touchmove",function(t){t.preventDefault(),t.stopImmediatePropagation(),g=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],v=e(this).parent(),w=v.offset(),S=g.pageX-w.left,y=g.pageY-w.top,p.data("horizontalScroll")?p.mCustomScrollbar("scrollTo",x-S,{trigger:"internal"}):p.mCustomScrollbar("scrollTo",b-y,{trigger:"internal"})})}if(p.data("bindEvent_scrollbar_click")||(o.bind("click",function(t){var i=(t.pageY-o.offset().top)*p.data("scrollAmount"),n=e(t.target);p.data("horizontalScroll")&&(i=(t.pageX-o.offset().left)*p.data("scrollAmount")),(n.hasClass("mCSB_draggerContainer")||n.hasClass("mCSB_draggerRail"))&&p.mCustomScrollbar("scrollTo",i,{trigger:"internal",scrollEasing:"draggerRailEase"})}),p.data({bindEvent_scrollbar_click:!0})),p.data("mouseWheel")&&(p.data("bindEvent_mousewheel")||(t.bind("mousewheel",function(e,t){var i,s=p.data("mouseWheelPixels"),a=Math.abs(n.position().top),l=r.position().top,h=o.height()-r.height();p.data("normalizeMouseWheelDelta")&&(t=0>t?-1:1),"auto"===s&&(s=100+Math.round(p.data("scrollAmount")/2)),p.data("horizontalScroll")&&(l=r.position().left,h=o.width()-r.width(),a=Math.abs(n.position().left)),(t>0&&0!==l||0>t&&l!==h)&&(e.preventDefault(),e.stopImmediatePropagation()),i=a-t*s,p.mCustomScrollbar("scrollTo",i,{trigger:"internal"})}),p.data({bindEvent_mousewheel:!0}))),p.data("scrollButtons_enable"))if("pixels"===p.data("scrollButtons_scrollType"))p.data("horizontalScroll")?(h.add(l).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",T,E),p.data({bindEvent_buttonsContinuous_x:!1}),p.data("bindEvent_buttonsPixels_x")||(h.bind("click",function(e){e.preventDefault(),c(Math.abs(n.position().left)+p.data("scrollButtons_scrollAmount"))}),l.bind("click",function(e){e.preventDefault(),c(Math.abs(n.position().left)-p.data("scrollButtons_scrollAmount"))}),p.data({bindEvent_buttonsPixels_x:!0}))):(a.add(s).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",T,E),p.data({bindEvent_buttonsContinuous_y:!1}),p.data("bindEvent_buttonsPixels_y")||(a.bind("click",function(e){e.preventDefault(),c(Math.abs(n.position().top)+p.data("scrollButtons_scrollAmount"))}),s.bind("click",function(e){e.preventDefault(),c(Math.abs(n.position().top)-p.data("scrollButtons_scrollAmount"))}),p.data({bindEvent_buttonsPixels_y:!0})));else if(p.data("horizontalScroll")){if(h.add(l).unbind("click"),p.data({bindEvent_buttonsPixels_x:!1}),!p.data("bindEvent_buttonsContinuous_x")){h.bind("mousedown touchstart MSPointerDown",function(e){e.preventDefault();var t=d();p.data({mCSB_buttonScrollRight:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(n.position().left)+t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var T=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollRight"))};h.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",T),l.bind("mousedown touchstart MSPointerDown",function(e){e.preventDefault();var t=d();p.data({mCSB_buttonScrollLeft:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(n.position().left)-t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var E=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollLeft"))};l.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",E),p.data({bindEvent_buttonsContinuous_x:!0})}}else if(a.add(s).unbind("click"),p.data({bindEvent_buttonsPixels_y:!1}),!p.data("bindEvent_buttonsContinuous_y")){a.bind("mousedown touchstart MSPointerDown",function(e){e.preventDefault();var t=d();p.data({mCSB_buttonScrollDown:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(n.position().top)+t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var C=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollDown"))};a.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",C),s.bind("mousedown touchstart MSPointerDown",function(e){e.preventDefault();var t=d();p.data({mCSB_buttonScrollUp:setInterval(function(){p.mCustomScrollbar("scrollTo",Math.abs(n.position().top)-t,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var _=function(e){e.preventDefault(),clearInterval(p.data("mCSB_buttonScrollUp"))};s.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",_),p.data({bindEvent_buttonsContinuous_y:!0})
}p.data("autoScrollOnFocus")&&(p.data("bindEvent_focusin")||(t.bind("focusin",function(){t.scrollTop(0).scrollLeft(0);var i=e(document.activeElement);if(i.is("input,textarea,select,button,a[tabindex],area,object")){var o=n.position().top,r=i.position().top,s=t.height()-i.outerHeight();p.data("horizontalScroll")&&(o=n.position().left,r=i.position().left,s=t.width()-i.outerWidth()),(0>o+r||o+r>s)&&p.mCustomScrollbar("scrollTo",r,{trigger:"internal"})}}),p.data({bindEvent_focusin:!0}))),p.data("autoHideScrollbar")&&(p.data("bindEvent_autoHideScrollbar")||(t.bind("mouseenter",function(){t.addClass("mCS-mouse-over"),i.showScrollbar.call(t.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(e){t.removeClass("mCS-mouse-over"),"mouseleave"===e.type&&i.hideScrollbar.call(t.children(".mCSB_scrollTools"))}),p.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(t,n){function o(e){switch(this.mcs={top:p.position().top,left:p.position().left,draggerTop:g.position().top,draggerLeft:g.position().left,topPct:Math.round(100*Math.abs(p.position().top)/Math.abs(p.outerHeight()-d.height())),leftPct:Math.round(100*Math.abs(p.position().left)/Math.abs(p.outerWidth()-d.width()))},e){case"onScrollStart":u.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(u,this.mcs);break;case"whileScrolling":u.data("whileScrolling_Callback").call(u,this.mcs);break;case"onScroll":u.data("onScroll_Callback").call(u,this.mcs);break;case"onTotalScrollBack":u.data("onTotalScrollBack_Callback").call(u,this.mcs);break;case"onTotalScroll":u.data("onTotalScroll_Callback").call(u,this.mcs)}}var r,s,a,l,h,u=e(this),c={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:u.data("scrollInertia"),scrollEasing:u.data("scrollEasing")},n=e.extend(c,n),d=u.children(".mCustomScrollBox"),p=d.children(".mCSB_container"),m=d.children(".mCSB_scrollTools"),f=m.children(".mCSB_draggerContainer"),g=f.children(".mCSB_dragger"),v=draggerSpeed=n.scrollInertia;if(u.data({mCS_trigger:n.trigger}),u.data("mCS_Init")&&(n.callbacks=!1),t||0===t){if("number"==typeof t)n.moveDragger?(r=t,t=u.data("horizontalScroll")?g.position().left*u.data("scrollAmount"):g.position().top*u.data("scrollAmount"),draggerSpeed=0):r=t/u.data("scrollAmount");else if("string"==typeof t){var w;w="top"===t?0:"bottom"!==t||u.data("horizontalScroll")?"left"===t?0:"right"===t&&u.data("horizontalScroll")?p.outerWidth()-d.width():"first"===t?u.find(".mCSB_container").find(":first"):"last"===t?u.find(".mCSB_container").find(":last"):u.find(t):p.outerHeight()-d.height(),1===w.length?(t=u.data("horizontalScroll")?w.position().left:w.position().top,r=t/u.data("scrollAmount")):r=t=w}u.data("horizontalScroll")?(u.data("onTotalScrollBack_Offset")&&(a=-u.data("onTotalScrollBack_Offset")),u.data("onTotalScroll_Offset")&&(h=d.width()-p.outerWidth()+u.data("onTotalScroll_Offset")),0>r?(r=t=0,clearInterval(u.data("mCSB_buttonScrollLeft")),a||(s=!0)):r>=f.width()-g.width()?(r=f.width()-g.width(),t=d.width()-p.outerWidth(),clearInterval(u.data("mCSB_buttonScrollRight")),h||(l=!0)):t=-t,i.mTweenAxis.call(this,g[0],"left",Math.round(r),draggerSpeed,n.scrollEasing),i.mTweenAxis.call(this,p[0],"left",Math.round(t),v,n.scrollEasing,{onStart:function(){n.callbacks&&!u.data("mCS_tweenRunning")&&o("onScrollStart"),u.data("autoHideScrollbar")&&i.showScrollbar.call(m)},onUpdate:function(){n.callbacks&&o("whileScrolling")},onComplete:function(){n.callbacks&&(o("onScroll"),(s||a&&p.position().left>=a)&&o("onTotalScrollBack"),(l||h&&p.position().left<=h)&&o("onTotalScroll")),g.data("preventAction",!1),u.data("mCS_tweenRunning",!1),u.data("autoHideScrollbar")&&(d.hasClass("mCS-mouse-over")||i.hideScrollbar.call(m))}})):(u.data("onTotalScrollBack_Offset")&&(a=-u.data("onTotalScrollBack_Offset")),u.data("onTotalScroll_Offset")&&(h=d.height()-p.outerHeight()+u.data("onTotalScroll_Offset")),0>r?(r=t=0,clearInterval(u.data("mCSB_buttonScrollUp")),a||(s=!0)):r>=f.height()-g.height()?(r=f.height()-g.height(),t=d.height()-p.outerHeight(),clearInterval(u.data("mCSB_buttonScrollDown")),h||(l=!0)):t=-t,i.mTweenAxis.call(this,g[0],"top",Math.round(r),draggerSpeed,n.scrollEasing),i.mTweenAxis.call(this,p[0],"top",Math.round(t),v,n.scrollEasing,{onStart:function(){n.callbacks&&!u.data("mCS_tweenRunning")&&o("onScrollStart"),u.data("autoHideScrollbar")&&i.showScrollbar.call(m)},onUpdate:function(){n.callbacks&&o("whileScrolling")},onComplete:function(){n.callbacks&&(o("onScroll"),(s||a&&p.position().top>=a)&&o("onTotalScrollBack"),(l||h&&p.position().top<=h)&&o("onTotalScroll")),g.data("preventAction",!1),u.data("mCS_tweenRunning",!1),u.data("autoHideScrollbar")&&(d.hasClass("mCS-mouse-over")||i.hideScrollbar.call(m))}})),u.data("mCS_Init")&&u.data({mCS_Init:!1})}},stop:function(){var t=e(this),n=t.children().children(".mCSB_container"),o=t.children().children().children().children(".mCSB_dragger");i.mTweenAxisStop.call(this,n[0]),i.mTweenAxisStop.call(this,o[0])},disable:function(t){var i=e(this),n=i.children(".mCustomScrollBox"),o=n.children(".mCSB_container"),r=n.children(".mCSB_scrollTools"),s=r.children().children(".mCSB_dragger");n.unbind("mousewheel focusin mouseenter mouseleave touchend"),o.unbind("touchstart touchmove"),t&&(i.data("horizontalScroll")?s.add(o).css("left",0):s.add(o).css("top",0)),r.css("display","none"),o.addClass("mCS_no_scrollbar"),i.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var t=e(this);t.removeClass("mCustomScrollbar _mCS_"+t.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),e(document).unbind("mousemove."+t.data("mCustomScrollbarIndex")+" mouseup."+t.data("mCustomScrollbarIndex")+" MSPointerMove."+t.data("mCustomScrollbarIndex")+" MSPointerUp."+t.data("mCustomScrollbarIndex")),e(window).unbind("resize."+t.data("mCustomScrollbarIndex"))}},i={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(e,t,i,n,o,r){function s(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()}function a(){v||p.call(),v=s()-g,l(),v>=e._time&&(e._time=v>e._time?v+d-(v-e._time):v+d-1,e._time<v+1&&(e._time=v+1)),e._time<n?e._id=_request(a):f.call()}function l(){n>0?(e.currVal=c(e._time,w,S,n,o),y[t]=Math.round(e.currVal)+"px"):y[t]=i+"px",m.call()}function h(){d=1e3/60,e._time=v+d,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return l(),setTimeout(e,.01)},e._id=_request(a)}function u(){null!=e._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._id):clearTimeout(e._id),e._id=null)}function c(e,t,i,n,o){switch(o){case"linear":return i*e/n+t;case"easeOutQuad":return e/=n,-i*e*(e-2)+t;case"easeInOutQuad":return e/=n/2,1>e?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t);case"easeOutCubic":return e/=n,e--,i*(e*e*e+1)+t;case"easeOutQuart":return e/=n,e--,-i*(e*e*e*e-1)+t;case"easeOutQuint":return e/=n,e--,i*(e*e*e*e*e+1)+t;case"easeOutCirc":return e/=n,e--,i*Math.sqrt(1-e*e)+t;case"easeOutSine":return i*Math.sin(e/n*(Math.PI/2))+t;case"easeOutExpo":return i*(-Math.pow(2,-10*e/n)+1)+t;case"mcsEaseOut":var r=(e/=n)*e,s=r*e;return t+i*(.499999999999997*s*r+-2.5*r*r+5.5*s+-6.5*r+4*e);case"draggerRailEase":return e/=n/2,1>e?i/2*e*e*e+t:(e-=2,i/2*(e*e*e+2)+t)}}var d,r=r||{},p=r.onStart||function(){},m=r.onUpdate||function(){},f=r.onComplete||function(){},g=s(),v=0,w=e.offsetTop,y=e.style;"left"===t&&(w=e.offsetLeft);var S=i-w;u(),h()},mTweenAxisStop:function(e){null!=e._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._id):clearTimeout(e._id),e._id=null)},rafPolyfill:function(){for(var e=["ms","moz","webkit","o"],t=e.length;--t>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"]}};i.rafPolyfill.call(),e.support.touch=!!("ontouchstart"in window),e.support.msPointer=window.navigator.msPointerEnabled;var n="https:"==document.location.protocol?"https:":"http:";e.event.special.mousewheel||document.write('<script src="'+n+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"></script>'),e.fn.mCustomScrollbar=function(i){return t[i]?t[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void e.error("Method "+i+" does not exist"):t.init.apply(this,arguments)}}(jQuery);var Timeline=function(e){if(this.DOMId=e.DOMId,this.DOMContainerSelector=e.DOMContainerSelector||"body",this.tlWidth=e.tlWidth||1e4,this.tlPxWidth=e.tlPxWidth||3e3,this.ptPxWidth=e.ptPxWidth||10,this.graduation=e.graduation,this.widthRatio=1,this.points=[],this.isRendered=!1,this.$tl=$("<div class='timeline' id='"+this.DOMId+"'></div>"),this.$tlContainer=$("<div class='timeline-container'></div>").appendTo(this.$tl),this.$tlPointsContainer=$("<div class='timeline-points-container'></div>").appendTo(this.$tlContainer),this.$tlGraduationContainer=$("<div class='timeline-graduation-container'></div>").appendTo(this.$tlContainer),this.graduation)for(var t=0;t<this.tlWidth/this.graduation.step;++t)$("<div class='timeline-graduation'>"+this.graduation.legend(t)+"</div>").addClass(this.graduation.cssClass(t)).appendTo(this.$tlGraduationContainer)};Timeline.prototype.add=function(e,t){var i=this.points.push({id:e,pos:t,$point:$("<div class='timeline-point'></div>").appendTo(this.$tlPointsContainer)});return this.isRendered===!0&&this.render(),this.points[i-1]},Timeline.prototype.calcWidthRatio=function(){return this.tlPxWidth/this.tlWidth},Timeline.prototype.resize=function(e){return isNaN(e)?!1:(this.tlPxWidth=e,this.render(),!0)},Timeline.prototype.bind=function(e,t){var i=this;return this.$tlPointsContainer.on(e,function(e){var n=$(e.target);n.hasClass("timeline-point")&&t.call(i,n.data("id"))}),this},Timeline.prototype.scrollTo=function(e){try{var t=_.find(this.points,function(t){return t.id==e?t:!1}).pxPos;this.$tl.mCustomScrollbar("scrollTo",t+(this.ptPxWidth-$(window).width())/2)}catch(i){}},Timeline.prototype.render=function(){var e,t,i,n,o=this.graduation.step,r=this.ptPxWidth,s=$(window).width();for(this.tlPxWidth<s&&(this.tlPxWidth=s),this.widthRatio=e=this.calcWidthRatio(),this.$tlContainer.css({width:this.tlPxWidth+"px"}),this.points=_.sortBy(this.points,function(e){return parseInt(e.pos)}),t=0;t<this.points.length;++t)i=this.points[t],i.pxPos=Math.floor(i.pos*e),t>0&&(n=this.points[t-1].pxPos+r+4,i.pxPos<n&&(i.pxPos=n)),i.$point.css({width:this.ptPxWidth+"px",left:i.pxPos+"px"});return this.graduation&&this.$tlGraduationContainer.children().each(function(t){$(this).css({left:t*o*e+"px"})}),this.$tl.parents(":last").is("html")===!1?(this.$tl.appendTo($(this.DOMContainerSelector)),this.$tl.mCustomScrollbar({horizontalScroll:!0,advanced:{autoExpandHorizontalScroll:!0}})):this.$tl.mCustomScrollbar("update"),this.isRendered=!0,this};var Quadrant=function(e){"use strict";var t={DOMContainerSelector:"body",HTMLStructure:"<div></div>",defaultDuration:0,defaultEasing:"swing"};e=$.extend(t,e),this.DOMContainerSelector=e.DOMContainerSelector,this.HTMLStructure=e.HTMLStructure,this.defaultDuration=e.defaultDuration,this.defaultEasing=e.defaultEasing,this.DOMId=e.DOMId,this.isRendered=!1,this.isScrolling=!1,this.$quadrant=$("<div class='quadrant' id='"+this.DOMId+"'></div>"),this.width=0,this.height=0,this.scrollQueue=[],this.currentPos="center","string"==typeof this.HTMLStructure&&(this.HTMLStructure=[this.HTMLStructure])};Quadrant.prototype.hide=function(){this.isRendered&&this.$quadrant.hide()},Quadrant.prototype.show=function(){this.isRendered&&this.$quadrant.show()},Quadrant.prototype.clearQueue=function(){this.scrollQueue=[],this.isScrolling=!1},Quadrant.prototype.render=function(){"use strict";var e,t,i=$(this.DOMContainerSelector),n=this.$quadrant,o=0,r=this.HTMLStructure.length;if(this.hide(),e=this.width=i.outerWidth(!1),t=this.height=i.outerHeight(!1),n.parents(":last").is("html")===!1){for(o=0;4>o;++o)$(this.HTMLStructure[o%r]).addClass("quadrant-zone").addClass("quadrant-zone"+(o+1)).appendTo(n);n.appendTo(i)}n.css({width:e+"px",height:t+"px"}),n.children().css({width:e+"px",height:t+"px"}),n.children().eq(0).css({left:"0px",top:"0px"}),n.children().eq(1).css({left:e+"px",top:"0px"}),n.children().eq(2).css({left:e+"px",top:t+"px"}),n.children().eq(3).css({left:"0px",top:t+"px"}),this.show(),this.isRendered===!1?(this.isRendered=!0,this.scrollTo({pos:"center",duration:0})):this.scrollTo({pos:this.currentPos,duration:0})},Quadrant.prototype.getHeight=function(){return this.height},Quadrant.prototype.getWidth=function(){return this.width},Quadrant.prototype.scrollTo=function(e){"use strict";function t(e){{var t=n.currentPos=e.pos;e.onAfter}delete e.pos,n.isScrolling=!0,0===t?(r.scrollTo({left:n.width/2+"px",top:n.height/2+"px"},e),r.fadeTo(e.duration,.5)):(r.scrollTo(r.children().eq(t-1),e),r.fadeTo(e.duration,1))}var i,n=this,o={pos:0,duration:this.defaultDuration,easing:this.defaultEasing,onAfter:$.noop},r=this.$quadrant;e=$.extend(o,e),i=e.onAfter,e.pos=parseInt(e.pos),(isNaN(e.pos)||e.pos<0||e.pos>4)&&(e.pos=0),e.onAfter=function(){"function"==typeof i&&i(),n.scrollQueue.length>0?t(n.scrollQueue.shift()):n.isScrolling=!1},this.scrollQueue.push(e),this.isScrolling===!1&&t(this.scrollQueue.shift())};var DeepZoom=function(e){e=$.extend({zoomControls:!0,closeButton:!0},e);var t=e.$el.eq(0),i=e.url.replace(/\/?$/,"/"),n=!!e.zoomControls,o=!!e.closeButton,r=e.width,s=e.height,a=t.attr("id");if(_.isUndefined(t))throw"DeepZoom: container element not specified";(void 0===a||null===a.match(/^[a-zA-Z][\w:.-]*$/g))&&(a=t.attr("id","dzcontainer").attr("id")),this.url=i,this.$el=t,this.id=a,this.width=r,this.height=s,this.closeButton=o,this.zoomControls=n,this.open()};DeepZoom.prototype.open=function(){var e=this;this.viewer=OpenSeadragon({id:this.id,autoHideControls:!0,wrapHorizontal:!1,wrapVertical:!1,animationTime:1.5,minZoomImageRatio:.5,maxZoomPixelRatio:3,showNavigationControl:!1,showNavigator:!1,mouseNavEnabled:!0,preserveViewport:!1,visibilityRatio:.5,zoomPerClick:1.4,zoomPerScroll:1.1}),this.viewer.open({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:this.url,Format:"jpg",Overlap:"1",TileSize:"256",Size:{Height:this.height.toString(),Width:this.width.toString()}}}),(this.zoomControls||this.closeButton)&&this.initControls(),this.$el.is(":visible")===!1&&this.$el.fadeIn(500,function(){$(document).one("keyup",function(t){27===t.which&&e.close()}),e.$el.css({cursor:"move"})}),this.isOpen=!0},DeepZoom.prototype.close=function(){var e=this;this.$el.fadeOut(500,function(){e.viewer.destroy()})},DeepZoom.prototype.initControls=function(){function e(e){return 100*Math.log(e/c.viewer.viewport.getMinZoom())/Math.log(2)}function i(e){return c.viewer.viewport.getMinZoom()*Math.pow(2,e/100)}function n(){return e(null!=(t=c.viewer.viewport)?t.getMinZoom():void 0)}function o(){return e(null!=(t=c.viewer.viewport)?t.getMaxZoom():void 0)}function r(){return e(null!=(t=c.viewer.viewport)?t.getZoom():void 0)}function s(){return l(c.viewer.zoomPerClick)}function a(){return l(1/c.viewer.zoomPerClick)}function l(e){c.viewer.viewport.zoomBy(e),c.viewer.viewport.applyConstraints()}var h,u,c=this;this.zoomControls&&($("<div class='dzzoomcontrols'><div class='dzscalebutton minus'></div><div class='dzslider'></div><div class='dzscalebutton plus'></div></div>").appendTo(this.$el),h=this.$el.find(".dzslider"),this.viewer.addHandler("open",function(){h.slider({min:n(),max:o(),value:r(),slide:function(e,t){return c.viewer.viewport.zoomTo(i(t.value))}}),c.viewer.addHandler("zoom",function(){h.slider("value",r())}),$(".dzscalebutton.minus").on("click",a),$(".dzscalebutton.plus").on("click",s)})),this.closeButton&&(u=$("<div class='dzclosebutton'></div>").appendTo(this.$el),u.on("click",function(){c.close()})),"ontouchstart"in document.documentElement==!1&&$("body").spotlight({fadeables:".dzzoomcontrols, .dzclosebutton",interval:800})},function(){"use strict";var e={};e.config={},e.config.timeline={DOMId:"timeline",DOMContainerSelector:"body",tlPxWidth:7e3,ptPxWidth:12,tlWidth:24471,graduation:{step:24471/67,cssClass:function(e){return(1912+e)%10===0?"g1":"g2"},legend:function(e){return 1912+e}}},e.config.quadrant={DOMId:"quadrant",DOMContainerSelector:".container",defaultDuration:500,defaultEasing:"easeInOutSine"},e.templates={point:"<div class='left'><article><div class='cat cat{{&cat.id}}'>{{&cat.name}}</div><h1>{{&title}}</h1><div class='text-container'><div class='text-content'>{{&desc}}{{#m}}{{#renderCaption}}{{/renderCaption}}{{/m}}</div></div></article></div><div class='right'>{{#m}}{{#renderImg}}{{/renderImg}}{{/m}}</div>",img:"<div class='media' width='{{&width}}' height='{{&height}}'><img src='//cf.pasoliniroma.com/static/langlois/img/{{&id}}.jpg' alt='{{&caption}}'></div>",video:"<div class='media' width='{{&width}}' height='{{&height}}'><iframe width='{{&width}}' height='{{&height}}' src='video.php?id={{&id}}'></iframe></div>",caption:"<div class='caption'>Illustration : {{&caption}} {{&rights}}</div>"},e.$={container:$(".container").eq(0)},e.controller=function(){var t,i=e.state.save(),n=i.type,o=i.id||null;"index"===n&&e.renderIndex(),"point"===n&&o&&(t=e.points.get(o),t.isComplete?e.renderPoint(t):$.when(e.fetchData("data/points/"+o+".json")).then(function(i){t=$.extend(t,i,{isComplete:!0}),e.renderPoint(t)},e.fail))},e.fail=function(){e.state.navigate({type:"index",id:null})},e.fetchData=function(e){return $.getJSON(e)},e.init=function(t){e.points=_.sortBy(t,function(e){return e.pos}),_.each(e.points,function(t,i){_.isUndefined(e.points[i-1])||_.extend(t,{prev:e.points[i-1].id}),_.isUndefined(e.points[i+1])||_.extend(t,{next:e.points[i+1].id})}),e.points.get=function(e){return _.find(this,function(t){return t.id===e})},e.timeline=new Timeline(e.config.timeline),e.quadrant=new Quadrant(e.config.quadrant),e.$pointContainer=$("<div class='point-container'></div>").appendTo(".container"),_.each(e.points,function(t){var i=e.timeline.add(t.id,t.pos).$point;i.attr("data-id",t.id),i.addClass("icon"+t.cat),t.$timelineElement=i}),Path.root("#!/index"),Path.map("#!/index").to(e.controller),Path.map("#!/:point(/:id)").to(e.controller),Path.rescue(function(){alert("No route found")}),Path.listen(),e.timeline.bind("click",function(t){e.state.navigate({type:"point",id:t})}).render(),e.timeline.scrollTo(_.last(e.points).id),$(window).on("debouncedresize.main",e.quadrant,function(t){var i=t.data;i.render(),i.scrollTo({pos:i.currentPos}),e.$.container.css({backgroundImage:"url(css/images/langlois.jpg)"}),_.isUndefined(e.$pointContainer)||(e.pointResize(),e.$pointContainer.hide().css({visibility:"visible"}).fadeIn(500),$(".text-container").perfectScrollbar("update"))}).trigger("debouncedresize.main")},e.renderIndex=function(){e.state.transitionOut(function(){e.$pointContainer.hide().html("<div class='center'><p>La vie d'Henri Langlois (1914-1977) se confond largement avec l'existence de la Cinmathque franaise, institution qu'il a cre en 1936 avec Georges Franju, Paul-Auguste Harl et Jean Mitry.</p><p> travers plus de 120 dates, importantes ou anecdotiques, parcourez en tous sens l'histoire mouvemente de l'homme qui a poursuivi inlassablement la mission qu'il s'tait fix : sauver les films de la destruction et de l'oubli, les montrer.</p><p><a class='enter' href='#!/point/113'>Entrer</a></p></div>"),$(".timeline-point-on").removeClass("timeline-point-on"),e.quadrant.scrollTo({pos:0,onAfter:function(){e.$pointContainer.fadeIn(500)}})})},e.renderPoint=function(t){e.state.transitionOut(function(){t.renderImg=function(){return function(t,i){return"img"===this.type?i(e.templates.img):"video"===this.type?i(e.templates.video):void 0}},t.renderCaption=function(){return function(t,i){return this.caption||this.rights?i(e.templates.caption):void 0}},$(".loading").show(),e.$pointContainer.hide(),e.$pointContainer.html(Mustache.render(e.templates.point,t)).imagesLoaded(function(){$(".loading").hide(),$(document).on("keyup",function(i){37===i.which&&t.prev&&e.state.navigate({type:"point",id:t.prev}),39===i.which&&t.next&&e.state.navigate({type:"point",id:t.next})}),$(".media > img").on("click",function(){e.dz=new DeepZoom({$el:$(".overlay"),url:"http://cf.pasoliniroma.com/static/langlois/dz/"+t.m.id,width:t.m.width,height:t.m.height})}),e.pointResize(t),e.quadrant.scrollTo({pos:t.cat.id,onAfter:function(){e.$pointContainer.hide().css({visibility:"visible"}).fadeIn(500)}}),$(".timeline-point-on").removeClass("timeline-point-on"),t.$timelineElement.addClass("timeline-point-on"),e.timeline.scrollTo(t.id)})})},e.pointResize=function(t){var i,n,o=e.$pointContainer.css({visibility:"hidden",display:"block"}),r=o.children(".left").eq(0),s=o.children(".right").eq(0),a=r.children("article").eq(0),l=s.children(".media").eq(0),h=a.children(".text-container").eq(0),u=h.children(".text-content").eq(0),c=fitInBox(l.attr("width"),l.attr("height"),o.innerWidth()/2,o.innerHeight(),!0);i={containerHeight:o.innerHeight(),articleHeight:a.innerHeight()},l.css({width:c.width+"px",height:c.height+"px"}),s.css({width:c.width+"px"}),r.css({width:o.innerWidth()-c.width+"px"}),n=Math.max((i.containerHeight-i.articleHeight)/2,0),a.css({paddingTop:n+"px"}),s.css({paddingTop:(i.containerHeight-c.height)/2+"px"}),0===n&&(u.css({paddingBottom:"24px",paddingRight:"12px"}),h.css({height:r.innerHeight()-h.position().top-8+"px"}).perfectScrollbar({suppressScrollX:!0}));try{"video"===t.m.type&&$("<script>brightcove.createExperiences();</script>").appendTo(l)}catch(d){}o.css({visibility:"visible",display:"none"})},e.state=function(){var t,i,n,o,r,s,a;return n=function(){return t},o=function(){return i},r=function(e){var t=this.get(),i=e.type||t.type,n=e.hasOwnProperty("id")?e.id:t.id;window.location.hash="#!/"+i+(n?"/"+n:"")},s=function(){var n={},o=window.location.hash.split("/");return n.type=o[1]||"index",o[2]&&(n.id=parseInt(o[2],10)),"point"===n.type&&(_.find(e.points,function(e){return e.id===n.id})?n.cat=e.points.get(n.id).cat:n={type:"index"}),i=t||{},t=n,n},a=function(t){"function"!=typeof t&&(t=$.noop),!_.isUndefined(e.dz)&&e.dz.isOpen&&e.dz.close(),"point"===i.type||"index"===i.type?e.$pointContainer.fadeOut(250,function(){t.call()}):t.call()},{get:n,getOld:o,navigate:r,save:s,transitionOut:a}}(),$(function(){$.when(e.fetchData("data/index.json")).then(e.init,e.fail)})}();